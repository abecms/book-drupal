<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Drupal Stickers Book Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Drupal Stickers Book Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Drupal Stickers Book" href="/opensearch.xml"><title data-react-helmet="true">modules | Drupal Stickers Book</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="modules | Drupal Stickers Book"><meta data-react-helmet="true" name="description" content="Modules"><meta data-react-helmet="true" property="og:description" content="Modules"><meta data-react-helmet="true" property="og:url" content="https://drupal.livingcolor.academy/docs/dynamisation/modules"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo-white.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://drupal.livingcolor.academy/docs/dynamisation/modules"><link rel="stylesheet" href="/styles.e5366e45.css">
<link rel="preload" href="/styles.dd3b91b9.js" as="script">
<link rel="preload" href="/runtime~main.089246bf.js" as="script">
<link rel="preload" href="/main.901730ae.js" as="script">
<link rel="preload" href="/1.610b12b6.js" as="script">
<link rel="preload" href="/2.2611d948.js" as="script">
<link rel="preload" href="/41.ff57316b.js" as="script">
<link rel="preload" href="/44.23577ab9.js" as="script">
<link rel="preload" href="/935f2afb.70e75e8c.js" as="script">
<link rel="preload" href="/17896441.ea08961a.js" as="script">
<link rel="preload" href="/3db804d2.db1c895f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="livingcolor" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="livingcolor" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Drupal Stickers Recipes</strong></a><a class="navbar__item navbar__link" href="/docs/setup/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="livingcolor" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="livingcolor" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Drupal Stickers Recipes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/setup/introduction">Docs</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/introduction">introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/setup">setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/configuration">configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/multilingue">multilingue</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/webforms">webforms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/blocks">blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/commerce">commerce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/nodes">nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/seo">seo</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Dynamisation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/nodes">nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/paragraphs">paragraphs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/views">views</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/search">search</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/forms">forms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/taxonomies">taxonomies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/tokens">tokens</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/images">images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/users">users</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/comments">comments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/newsletters">newsletters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/menus">menus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/ckeditor">ckeditor</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/dynamisation/modules">modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamisation/domains">domains</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/dev">dev</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/debug">debug</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev/tests">tests</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">modules</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="modules"></a>Modules<a class="hash-link" href="#modules" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="core"></a>Core<a class="hash-link" href="#core" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="statistics"></a>statistics<a class="hash-link" href="#statistics" title="Direct link to heading">#</a></h3><p>Un patch a Ã©tÃ© crÃ©Ã© pour le projet &quot;Consommateurs &amp; Citoyen&quot;. Ce patch permet de rÃ©aliser des stats sur toutes les entitÃ©s et pas seulement les nodes. De plus, l&#x27;appel ajax d&#x27;incrÃ©mentation de la vue renvoie le compte de l&#x27;entitÃ©.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contrib"></a>Contrib<a class="hash-link" href="#contrib" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-and-activate-a-contrib-module"></a>Install and activate a contrib module<a class="hash-link" href="#install-and-activate-a-contrib-module" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install"></a>Install<a class="hash-link" href="#install" title="Direct link to heading">#</a></h4><p><strong>Never download a zip file or a tar.gz file to install a module</strong></p><ol><li>Find your module - ie: <code>https://www.drupal.org/project/search_api_synonym</code></li><li>Click on version link you need at the bottom of the page - ie: <code>8.x-1.2</code></li><li>Copy the composer command to install the command - ie: <code>composer require &#x27;drupal/search_api_synonym:^1.2&#x27;</code></li><li>Run this command at the root of the project</li></ol><p>Note: The module is installed but not active.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="activate"></a>Activate<a class="hash-link" href="#activate" title="Direct link to heading">#</a></h4><ol><li>Got to admin of your project - <code>/admin/modules</code></li><li>Search you module</li><li>Select it and click on install</li><li>Drupal will activate this module</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ajax-loader"></a>Ajax loader<a class="hash-link" href="#ajax-loader" title="Direct link to heading">#</a></h3><p>Pour remplacer le loader ajax drupal par un custom loader il faut :</p><ol><li>le module Ajax Loader - <code>https://www.drupal.org/project/ajax_loader</code></li><li>On copie le repertoire <code>modules/contrib/ajax_loader/src/Plugin/ajax_loader</code> dans le module customization <code>public/sites/default/modules/custom/customization/src/Plugin/ajax_loader</code></li><li>Les custom Loader commencent par <code>Trobbernomduloader.php</code></li><li>Ne garder qu&#x27;un seul fichier php et le renommer du nom du loader voulu <code>Trobbernomduclient.php</code> et
remplacer dans le fichier la class et la fonction pour ne pas provoquer de conflit avec le nom voulu.</li><li>Dans la fonction <code>setMarkup</code> remplacer le <code>return</code> par votre loader. ie:</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-php codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">protected function setMarkup() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return &#x27;&lt;div class=&quot;preloader-drupal&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol><li>Vider la cache depuis le B.O.</li><li>dans l&#x27;admin <code>admin/config/user-interface/ajax-loader</code> Choisissez votre loader qui apparait dans la liste dÃ©roulante.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="color-field"></a>color field<a class="hash-link" href="#color-field" title="Direct link to heading">#</a></h3><ol><li>Installer le module color field (<a href="https://www.drupal.org/project/color_field" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/color_field</a>)</li><li>Ajouter le champ color au contenu souhaitÃ© et le configurer dans la section &quot;gÃ©rer l&#x27;affichage du formulaire&quot;</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cookieconsent"></a>cookieconsent<a class="hash-link" href="#cookieconsent" title="Direct link to heading">#</a></h3><ol><li>Installer le module Cookie consent  (<a href="https://www.drupal.org/project/cookieconsent" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/cookieconsent</a>)</li><li>Configurer les donnÃ©e de personnalisation (texte, lien vers la page de consentement, css)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="simple-popup-blocks"></a>simple popup blocks<a class="hash-link" href="#simple-popup-blocks" title="Direct link to heading">#</a></h3><ol><li>Installer le module simple popup blocks  (<a href="https://www.drupal.org/project/simple_popup_blocks" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/simple_popup_blocks</a>)
Permet de crÃ©er des popin Ã  partir de n&#x27;importe quel contenu (mÃªme les formulaires)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="simplenews"></a>Simplenews<a class="hash-link" href="#simplenews" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ajouter-une-vue-sur-la-newsletter"></a>Ajouter une vue sur la newsletter<a class="hash-link" href="#ajouter-une-vue-sur-la-newsletter" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function YOURTHEME_preprocess_simplenews_newsletter_body(&amp;$variables) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$variables[&#x27;latestnews&#x27;] = views_embed_view(&#x27;latestnews&#x27;, &#x27;block_1&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Create a template for the newsletter body simplenews-newsletter-body--[newsletter_id].html.twig (newsletter_id = machine name). and add your view in it where you&#x27;d like to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ latestnews }}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configurer-simplenews"></a>configurer simplenews<a class="hash-link" href="#configurer-simplenews" title="Direct link to heading">#</a></h4><ul><li>installer simplenews et swiftmailer</li><li>CrÃ©er mytheme/templates/swiftmailer.html.twig et set mailsystem to use mytheme to render the emails.</li><li>set mailsystem to use swiftmailers default formatter plugin</li><li>set mailsystem to use swiftmailers default sender plugin</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pathauto"></a>Pathauto<a class="hash-link" href="#pathauto" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ajouter-des-conditions-sur-la-crÃ©ation-des-patterns-de-pathauto"></a>Ajouter des conditions sur la crÃ©ation des patterns de pathauto<a class="hash-link" href="#ajouter-des-conditions-sur-la-crÃ©ation-des-patterns-de-pathauto" title="Direct link to heading">#</a></h4><p>source: <a href="https://www.deeson.co.uk/labs/dynamic-patterns-pathauto" target="_blank" rel="noopener noreferrer">https://www.deeson.co.uk/labs/dynamic-patterns-pathauto</a></p><p>Si vous voulez par exemple crÃ©er des patterns en fonction d&#x27;un type de contenu <code>notice</code> et d&#x27;une valeur de champ de taxonomie <code>type_de_groupe</code></p><ol><li>CrÃ©er une classe de plugin de condition qui s&#x27;ajoutera aux conditions des patterns Pathauto</li><li>DÃ©clarer ce plugin Ã  Drupal</li><li>Injecter ce plugin de condition dans le formulaire de crÃ©ation/Ã©dition de pattern pathauto</li><li>Traiter la validation du formulaire de crÃ©ation/Ã©dition de pattern de pathauto</li></ol><p>Dans my_module/src/Plugin/Condition/ProgramGroup</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Drupal\my_module\Plugin\Condition;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Drupal\Core\Condition\ConditionPluginBase;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Drupal\Core\Entity\EntityFieldManagerInterface;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Drupal\Core\Form\FormStateInterface;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Drupal\Core\Plugin\ContainerFactoryPluginInterface;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Symfony\Component\DependencyInjection\ContainerInterface;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Provides a &#x27;Program Group&#x27; condition.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @Condition(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *   id = &quot;program_group&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *   label = @Translation(&quot;Program Group&quot;),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *   context = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *     &quot;node&quot; = @ContextDefinition(&quot;entity:node&quot;, label = @Translation(&quot;Node&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *   }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ProgramGroup extends ConditionPluginBase implements ContainerFactoryPluginInterface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   * The entity field manager.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   * @var \Drupal\Core\Entity\EntityFieldManagerInterface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    protected $fieldManager;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Creates a new ProgramGroup instance.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param \Drupal\Core\Entity\EntityFieldManagerInterface $field_manager</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   The entity field manager.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param array $configuration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   The plugin configuration, i.e. an array with configuration values keyed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   by configuration option name. The special key &#x27;context&#x27; may be used to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   initialize the defined contexts by setting it to an array of context</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   values keyed by context names.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param string $plugin_id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   The plugin_id for the plugin instance.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param mixed $plugin_definition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   The plugin implementation definition.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function __construct(EntityFieldManagerInterface $field_manager, array $configuration, $plugin_id, $plugin_definition)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        parent::__construct($configuration, $plugin_id, $plugin_definition);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $this-&gt;fieldManager = $field_manager;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static function create(ContainerInterface $container, array $configuration, $plugin_id, $plugin_definition)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return new static(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $container-&gt;get(&#x27;entity_field.manager&#x27;),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $configuration,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $plugin_id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $plugin_definition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function buildConfigurationForm(array $form, FormStateInterface $form_state)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $form[&#x27;program_group&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#title&#x27; =&gt; $this-&gt;t(&#x27;Program Group&#x27;),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#type&#x27; =&gt; &#x27;select&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#options&#x27; =&gt; $this-&gt;getProgramGroups(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#default_value&#x27; =&gt; $this-&gt;configuration[&#x27;program_group&#x27;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#empty_value&#x27; =&gt; &#x27;&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return parent::buildConfigurationForm($form, $form_state);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function submitConfigurationForm(array &amp;$form, FormStateInterface $form_state)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $this-&gt;configuration[&#x27;program_group&#x27;] = $form_state-&gt;getValue(&#x27;program_group&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        parent::submitConfigurationForm($form, $form_state);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function summary()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($program_group = $this-&gt;configuration[&#x27;program_group&#x27;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $program_groups = $this-&gt;getProgramGroups();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $replace = [&#x27;@program_group&#x27; =&gt; $program_groups[$program_group]];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return $this-&gt;isNegated()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ? $this-&gt;t(&#x27;Cette notice n\&#x27;appartient pas au groupe @program_group&#x27;, $replace)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                : $this-&gt;t(&#x27;Cette notice appartient au groupe @program_group&#x27;, $replace);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // If no list is selected it means the program group should not be listed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return $this-&gt;isNegated() ? $this-&gt;t(&#x27;The program group is listed&#x27;) : $this-&gt;t(&#x27;The program group is not listed&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function evaluate()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $node = $this-&gt;getContextValue(&#x27;node&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // This condition always fails if the node is not a notice.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($node-&gt;bundle() !== &#x27;notice&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return false;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Check whether the node is listed on the selected list.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $node_program_group = $node-&gt;field_groupe_de_programmes[0]-&gt;entity-&gt;name-&gt;value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($program_group = $this-&gt;configuration[&#x27;program_group&#x27;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return $node_program_group == $program_group xor $this-&gt;isNegated();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // If no list is selected it means the event should not be listed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return empty($node_program_group) xor $this-&gt;isNegated();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@inheritdoc}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function defaultConfiguration()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return [&#x27;program_group&#x27; =&gt; &#x27;&#x27;] + parent::defaultConfiguration();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Retrieves the possible event lists.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @return string[]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *   The list of possible event lists, keyed by their machine name.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function getProgramGroups()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $existingTerms = \Drupal::entityTypeManager()-&gt;getStorage(&#x27;taxonomy_term&#x27;)-&gt;loadTree(&#x27;groupe_de_programmes&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $taxoArray = [];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach ($existingTerms as $existingTerm) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $taxoArray[] = $existingTerm-&gt;name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return $taxoArray;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Dans my_module/config/schema/customization.schema.yml</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">condition.plugin.program_group:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type: condition.plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      program_group:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type: string</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Dans my_module/my_module.module</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Implements hook_form_FORM_ID_alter().</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @see \Drupal\pathauto\Form\PatternEditForm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function customization_form_pathauto_pattern_form_alter(&amp;$form, $form_state)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /** @var \Drupal\pathauto\Entity\PathautoPattern $entity */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $entity = $form_state-&gt;getFormObject()-&gt;getEntity();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($entity-&gt;get(&#x27;type&#x27;) == &#x27;canonical_entities:node&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Search the Pathauto pattern for our program_group condition.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach ($entity-&gt;getSelectionConditions() as $candidate) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if ($candidate-&gt;getPluginId() == &#x27;program_group&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                $condition = $candidate;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // If we could not find a configured condition, create an empty one.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (empty($condition)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            /** @var \Drupal\Core\Condition\ConditionManager $condition_manager */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $condition_manager = \Drupal::service(&#x27;plugin.manager.condition&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $condition = $condition_manager-&gt;createInstance(&#x27;program_group&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Add the condition plugin form to the form, removing the negate checkbox.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $condition_form = $condition-&gt;buildConfigurationForm($form[&#x27;pattern_container&#x27;], $form_state);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        unset($condition_form[&#x27;negate&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $form[&#x27;pattern_container&#x27;] += $condition_form;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Add our submit handler after ::submit but before ::save.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $offset = array_search(&#x27;::submit&#x27;, $form[&#x27;actions&#x27;][&#x27;submit&#x27;][&#x27;#submit&#x27;]) + 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        array_splice($form[&#x27;actions&#x27;][&#x27;submit&#x27;][&#x27;#submit&#x27;], $offset, 0, &#x27;customization_pathauto_pattern_submit&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Submit handler for form ID pathauto_pattern_form.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @see customization_form_pathauto_pattern_form_alter()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function customization_pathauto_pattern_submit($form, $form_state)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /** @var \Drupal\pathauto\Entity\PathautoPattern $entity */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $entity = $form_state-&gt;getFormObject()-&gt;getEntity();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($program_group = $form_state-&gt;getValue(&#x27;program_group&#x27;)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $entity-&gt;addSelectionCondition([</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;id&#x27; =&gt; &#x27;program_group&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;program_group&#x27; =&gt; $program_group,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;negate&#x27; =&gt; false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;context_mapping&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &#x27;node&#x27; =&gt; &#x27;node&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="permettre-de-gÃ©nÃ©rer-plusieurs-alias-pour-un-mÃªme-node-drupal-88"></a>Permettre de gÃ©nÃ©rer plusieurs alias pour un mÃªme node (Drupal &gt;8.8)<a class="hash-link" href="#permettre-de-gÃ©nÃ©rer-plusieurs-alias-pour-un-mÃªme-node-drupal-88" title="Direct link to heading">#</a></h4><p>(bien penser Ã  mettre le canonical sur la bonne URL racine). CrÃ©er plusieurs URL pour un mÃªme node peut Ãªtre pertinent.
On utilise le hook <code>HOOK_pathauto_alias_alter</code> :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function customization_pathauto_alias_alter(&amp;$alias, array &amp;$context)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (isset($context[&#x27;data&#x27;][&#x27;node&#x27;]) &amp;&amp; $context[&#x27;data&#x27;][&#x27;node&#x27;]-&gt;bundle() === &#x27;notice&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $node = $context[&#x27;data&#x27;][&#x27;node&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $typeProgramme = $node-&gt;field_type_de_programme[0]-&gt;entity-&gt;name-&gt;value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $groupeProgramme = $node-&gt;field_groupe_de_programmes[0]-&gt;entity-&gt;name-&gt;value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($typeProgramme === &#x27;programme&#x27; &amp;&amp;  $groupeProgramme === &#x27;unitaire&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $parts = explode(&#x27;/&#x27;, $alias);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $playerAlias = $alias.&#x27;/player/&#x27;.strtolower($node-&gt;field_identifiant-&gt;value).&#x27;/&#x27;.$parts[2];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $pathAlias = \Drupal\path_alias\Entity\PathAlias::create([</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              &#x27;path&#x27; =&gt; &#x27;/node/&#x27;.$node-&gt;id(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              &#x27;alias&#x27; =&gt; $playerAlias,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              &#x27;langcode&#x27; =&gt; &#x27;fr&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $pathAlias-&gt;save();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="metatag"></a>Metatag<a class="hash-link" href="#metatag" title="Direct link to heading">#</a></h3><ul><li>Installer le module metatag</li><li>Pour personnaliser un node, il suffit de crÃ©er un nouveau champ de type metatag pour ce type de contenu. Automatiquement, il permettra de personnaliser les meta sur chaque node (dans l&#x27;Ã©dition du node menu metatag Ã  droite)</li><li>pour placer l&#x27;image issue d&#x27;un champ du node qui est contenue dans un media : <code>[node:field_visuel:entity:field_media_image:entity:url]</code></li><li>pour activer et configurer le partage Facebook et twitter :<ul><li>Activer les modules Metatag: Twitter Cards et Metatag: Open Graph</li><li>Aller sous admin/config/search/metatag/settings et activer les options Open Graph et Twitter Cards pour les entitÃ©s concernÃ©es</li><li>Puis modifier les metatag par dÃ©faut : sans /admin/config/search/metatag<ul><li>pour l&#x27;entitÃ©  concernÃ©e cliquer sur modifier</li><li>ajouter la valeur souhaitÃ©e pour les diffÃ©rents tag. Exemple pour le metatag MEDIA VIDEO, mettre [media:field_poster:large] pour la version large de l&#x27;url du poster</li></ul></li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="change--add-metatags-links-title-for-a-specific-page-in-a-controller"></a>Change / add metatags, links, title for a specific page in a controller<a class="hash-link" href="#change--add-metatags-links-title-for-a-specific-page-in-a-controller" title="Direct link to heading">#</a></h4><ol><li>make sure that the Metatag module doesn&#x27;t have a global config for the tags you want to change</li><li>In your Controller, you may create a <code>$htmlHead</code> array. Then add your tags and links as follow (such an entry is composed by the array of data + a key (ie &#x27;linkprevious&#x27;))</li></ol><p>Consider the way we change the title of the page (<code>&#x27;#title&#x27; =&gt; &#x27;RÃ©sultats de recherche - &#x27;.$input</code>)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$htmlHead = [];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$urlWithoutSort = str_replace(&#x27;&amp;sort=&#x27;.$sort, &#x27;&#x27;, \Drupal::request()-&gt;getRequestUri());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$htmlHead[] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;#tag&#x27; =&gt; &#x27;meta&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;#attributes&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;name&#x27; =&gt; &#x27;canonical&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;content&#x27; =&gt; $urlWithoutSort,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;tag&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (true) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $htmlHead[] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#tag&#x27; =&gt; &#x27;link&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#attributes&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;rel&#x27; =&gt; &#x27;next&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;href&#x27; =&gt; str_replace(&#x27;&amp;page=&#x27;.$page, &#x27;&#x27;, $urlWithoutSort).&#x27;&amp;page=&#x27;.($page + 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;linkprevious&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if ($page &amp;&amp; $page &gt; 1) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $htmlHead[] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#tag&#x27; =&gt; &#x27;link&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;#attributes&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;rel&#x27; =&gt; &#x27;previous&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;href&#x27; =&gt; str_replace(&#x27;&amp;page=&#x27;.$page, &#x27;&#x27;, $urlWithoutSort).&#x27;&amp;page=&#x27;.($page - 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;linknext&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">return [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    self::QTHEME =&gt; &#x27;my_module_search_page&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#q&#x27; =&gt; $input,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#video&#x27; =&gt; (count($resultVideo[self::QHITS]) &gt; 0) ? true : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#audio&#x27; =&gt; (count($resultAudio[self::QHITS]) &gt; 0) ? true : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#article&#x27; =&gt; false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#children&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $resultVideo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $resultAudio,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#attached&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;html_head&#x27; =&gt; $htmlHead</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#title&#x27; =&gt; &#x27;RÃ©sultats de recherche - &#x27;.$input</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="elasticsearch"></a>ElasticSearch<a class="hash-link" href="#elasticsearch" title="Direct link to heading">#</a></h3><p>Note: <code>http://letstoob.info/drupal-8/how-to-integrate-elasticsearch-6-3-0-with-drupal-8-5/</code></p><p>2 modules necessaires:</p><ul><li>Elasticsearch connector - <code>https://www.drupal.org/project/elasticsearch_connector</code></li><li>Search Api - <code>https://www.drupal.org/project/search_api</code></li></ul><ol><li>Go to <code>admin/config/search/elasticsearch-connector</code></li><li>Click on ```Add Cluster````</li><li>Fill in <code>name</code> and URL <code>http://localhost:9200</code> ou <code>http://nameofthedocker:9200</code> if you use a docker elastic</li><li>Select <code>Select this cluster default connection</code></li><li>Select <code>Use multiple nodes connection</code></li><li>Click <code>save</code></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="videos-transcoding"></a>Videos transcoding<a class="hash-link" href="#videos-transcoding" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudstack-trancoding"></a>Cloudstack Trancoding<a class="hash-link" href="#cloudstack-trancoding" title="Direct link to heading">#</a></h4><p><code>https://aws.amazon.com/blogs/networking-and-content-delivery/serverless-video-on-demand-vod-workflow/</code></p><ul><li>If your s3 bucket is in north US-EAST (N. Virginia)</li><li>You need to apply this patch for s3fs_cors module for drupal cause this is the only region need to be http called without the region in URL</li><li><code>https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html#access-bucket-intro</code></li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-php codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">diff --git a/modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php b/modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">index 5902592e..99616251 100644</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--- a/modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+++ b/modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@@ -231,7 +231,7 @@ public static function processManagedFile(&amp;$element, FormStateInterface $form_st</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     // Pass the element parents through to the javascript function.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $js_settings[&#x27;element_parents&#x27;] = implode(&#x27;/&#x27;, $element_parents);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-    $js_settings[&#x27;cors_form_action&#x27;] = $cors_config-&gt;get(&#x27;s3fs_https&#x27;) . &#x27;://s3-&#x27; . $config-&gt;get(&#x27;region&#x27;) . &#x27;.amazonaws.com/&#x27; . $bucket . &#x27;/&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+    $js_settings[&#x27;cors_form_action&#x27;] = $cors_config-&gt;get(&#x27;s3fs_https&#x27;) . &#x27;://s3&#x27; . &#x27;.amazonaws.com/&#x27; . $bucket . &#x27;/&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $field_name = $element[&#x27;#field_name&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     if (!empty($element[&#x27;#field_parents&#x27;])) {</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudfront-and-s3-cors-config"></a>CloudFront and S3 CORS config<a class="hash-link" href="#cloudfront-and-s3-cors-config" title="Direct link to heading">#</a></h4><p><code>https://stackoverflow.com/questions/50022326/amazon-s3-image-cors-issue</code></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="s3-cors-config"></a>S3 CORS Config<a class="hash-link" href="#s3-cors-config" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-xml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSConfiguration</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://s3.amazonaws.com/doc/2006-03-01/</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">http://*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">https://*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">POST</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">MaxAgeSeconds</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">3000</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">MaxAgeSeconds</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">ExposeHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">x-amz-version-id</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">ExposeHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">GET</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">HEAD</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSConfiguration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudfront-config"></a>CloudFront Config<a class="hash-link" href="#cloudfront-config" title="Direct link to heading">#</a></h5><p><code>https://stackoverflow.com/questions/50022326/amazon-s3-image-cors-issue</code></p><ul><li>Got to <code>Behaviors</code> tab</li><li>Select your distribution but ticking it and click on <code>Edit</code></li><li><code>Cache Based on Selected Request Headers</code> set to <code>Whitelist</code></li><li><code>Whitelist Headers</code> add <code>Access-Control-Request-Headers</code>, <code>Access-Control-Request-Method</code> and <code>Origin</code></li><li><code>Object Caching</code> tick <code>Use Origin Cache Headers</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="drupal-8-config"></a>Drupal 8 Config<a class="hash-link" href="#drupal-8-config" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="modules-1"></a>Modules<a class="hash-link" href="#modules-1" title="Direct link to heading">#</a></h5><p>You&#x27;ll need 2 modules</p><ul><li><p>Run <code>composer require &#x27;drupal/s3fs:^3.0&#x27;</code></p></li><li><p>Run <code>composer require &#x27;drupal/s3fs_cors:^1.0&#x27;</code></p></li><li><p>You&#x27;ll need you AWS accesskey and secretkey</p></li><li><p>Edit your <code>settings.php</code></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-php codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/** S3 configuration security */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;s3fs.access_key&#x27;] = &#x27;youraccesskey&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;s3fs.secret_key&#x27;] = &#x27;yoursecretkey&#x27;;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="drupal-admin-config"></a>Drupal admin config<a class="hash-link" href="#drupal-admin-config" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="media-type"></a>Media Type<a class="hash-link" href="#media-type" title="Direct link to heading">#</a></h5><p>Structure &gt; Types de media &gt; Video &gt; GÃ©rer les champs
or <code>admin/structure/media/manage/video/fields</code></p><ul><li>VidÃ©o file &gt; modifier</li><li>Repertoire du fichier must be <code>input</code></li><li>ParamÃ¨tres du champs pick <code>S3 File System</code></li></ul><p><code>admin/structure/media/manage/video/form-display</code></p><ul><li>for <code>Video file</code> pick <code>S3fs Cors File Upload</code></li><li>Click on the toothed wheel to setup the FileSize Limit</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="s3-config"></a>S3 Config<a class="hash-link" href="#s3-config" title="Direct link to heading">#</a></h5><p>Go to <code>https://yourdrupalsite/admin/config/media/s3fs</code></p><ul><li>Fill your bucket previsouly created from AWS cloudstack</li><li>Tick ```Always serve files from S3 via HTTPS````</li></ul><p>Go to <code>admin/config/media/s3fs/cors</code></p><ul><li>tick <code>https</code> for <code>Use Https/Http</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="redis"></a>Redis<a class="hash-link" href="#redis" title="Direct link to heading">#</a></h3><p>Module Install - <code>https://www.drupal.org/project/redis</code></p><ol><li>Run <code>composer require &#x27;drupal/redis:^1.1&#x27;</code> in docroot</li><li>Activate module in Back Office</li><li>Clear the cache</li><li>Update <code>settings.php</code> with</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Redis Configuration.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;host&#x27;] =  &#x27;redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;port&#x27;] = NULL;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;cache&#x27;][&#x27;default&#x27;] = &#x27;cache.backend.redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;base&#x27;] = 8;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $conf[&#x27;chq_redis_cache_enabled&#x27;] = TRUE;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (isset($conf[&#x27;chq_redis_cache_enabled&#x27;]) &amp;&amp; $conf[&#x27;chq_redis_cache_enabled&#x27;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $settings[&#x27;redis.connection&#x27;][&#x27;interface&#x27;] = &#x27;PhpRedis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $settings[&#x27;cache&#x27;][&#x27;default&#x27;] = &#x27;cache.backend.redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Note that unlike memcached, redis persists cache items to disk so we can</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // actually store cache_class_cache_form in the default cache.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $conf[&#x27;cache_class_cache&#x27;] = &#x27;Redis_Cache&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="webform"></a>Webform<a class="hash-link" href="#webform" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="webform-children"></a>Webform children<a class="hash-link" href="#webform-children" title="Direct link to heading">#</a></h4><p>Les children de webform sont en fait des contenus dÃ©jÃ  prÃ©parÃ©s. On ne peut donc pas faire de <code>{{for child in children</code></p><p>Pour remplacer, ajouter, supprimer une classe par ex. il suffit juste d&#x27;utiliser la fonction replace de twig !</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ children | replace({&#x27;webform-flex &#x27;: &quot;webform-flex form__section &quot;}) | raw }}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conditionner-email-destinataire-selon-options-liste-dÃ©roulante"></a>Conditionner email destinataire selon options liste dÃ©roulante<a class="hash-link" href="#conditionner-email-destinataire-selon-options-liste-dÃ©roulante" title="Direct link to heading">#</a></h4><ol><li>Structure webform : CrÃ©er un formulaire ou modifier le formulaire concernÃ©</li><li>Tab construire : ajouter un champ &quot;liste de selection&quot; et saisir les diffÃ©rentes options</li><li>Tab Handler :</li></ol><ul><li>Ajouter un handler,</li><li>Dans &quot;Envoyer A&quot;, sÃ©lectionner la liste crÃ©er dans le formulaire</li><li>Pour chaque entrÃ©e de la liste saisir le destinataire concernÃ©</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="webform-recaptcha"></a>Webform recaptcha<a class="hash-link" href="#webform-recaptcha" title="Direct link to heading">#</a></h3><ol><li>Installer les modules Captcha et reCaptcha (<a href="https://www.drupal.org/project/recaptcha" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/recaptcha</a>)</li><li>Aller dans configuration/personnes/Captcha et configurer Captcha et reCaptcha : Bien crÃ©er un reCaptcha Google avec les bonnes clÃ©s et autorisant les bons domaines.</li><li>Aller dans le modÃ¨le du webform et ajouter un champ de type reCaptcha. Enjoy !</li><li>Important dÃ©cocher <code>Local domain name validation</code> dans la configuration drupal si il est cocher cÃ´tÃ©s serveur et inversement</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="datalayer"></a>Datalayer<a class="hash-link" href="#datalayer" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="bug-lors-de-la-suppresion-dun-inscrit-newsletter-via-simplenews"></a>Bug lors de la suppresion d&#x27;un inscrit newsletter (via simplenews)<a class="hash-link" href="#bug-lors-de-la-suppresion-dun-inscrit-newsletter-via-simplenews" title="Direct link to heading">#</a></h4><p>attention patch Ã  faire (manuel) sur datalayer.module pour Ã©viter un message d&#x27;erreur sur la suppression d&#x27;un inscrit newsletter (ligne 331) :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// For entities with an owner/author, get the username</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if ((empty($selected_properties) || array_key_exists(&#x27;name&#x27;, $properties))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;&amp; !isset($output_data[&#x27;entityName&#x27;]) &amp;&amp; is_object($entity-&gt;uid &amp;&amp; isset($entity-&gt;uid-&gt;entity-&gt;name))) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $output_data[&#x27;entityName&#x27;] = $entity-&gt;uid-&gt;entity-&gt;name-&gt;getString();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="amp"></a>AMP<a class="hash-link" href="#amp" title="Direct link to heading">#</a></h3><p>Permet de proposer la version AMP pour un node.
cf. <a href="https://www.drupal.org/docs/8/modules/accelerated-mobile-pages-amp/amp-version-82" target="_blank" rel="noopener noreferrer">https://www.drupal.org/docs/8/modules/accelerated-mobile-pages-amp/amp-version-82</a></p><p>Installer <code>composer require &#x27;drupal/schema_metatag:^1.3&#x27;</code> pour les micro-formats AMP</p><p>il y a actuellement un bug sur l&#x27;install de masterminds. Il faut faire :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">composer require drupal/amp masterminds/html5:~2.3.0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="flag"></a>flag<a class="hash-link" href="#flag" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="crÃ©er-ses-propres-liens-de-bookmarks-par-le-user"></a>CrÃ©er ses propres liens de bookmarks par le user<a class="hash-link" href="#crÃ©er-ses-propres-liens-de-bookmarks-par-le-user" title="Direct link to heading">#</a></h4><ul><li>utiliser le module flag(/admin/structure/flags) et:</li></ul><ol><li>crÃ©er un type de block (ex. myOwnBookmarks)</li><li>CrÃ©er un block de ce type (utilisons aussi myOwnBookmarks comme nom)</li><li>CrÃ©er un flag (aussi myOwnBookmarks :) associÃ© au type de bloc myOwnBookmarks.</li><li>Ajouter un champ link Ã  ce flag (qu&#x27;on peut limiter Ã  10 rÃ©pÃ©titions par ex. dans la config)</li><li>demandons l&#x27;affichage du flag en form popin puis sauvegardons le flag</li><li>Si on affiche le bloc myOwnBookmarks dans une rÃ©gion, on aura l&#x27;affichage du flag. au clic, popin avec le fomulaire de saisie des links !</li><li>Il ne reste plus qu&#x27;Ã  crÃ©er une vue qui affiche le contenu du flag, et Ã  utiliser cette vue ou on veut.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="bug-dans-le-module--httpswwwdrupalorgprojectflagissues2888268"></a>bug dans le module : <a href="https://www.drupal.org/project/flag/issues/2888268" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/flag/issues/2888268</a><a class="hash-link" href="#bug-dans-le-module--httpswwwdrupalorgprojectflagissues2888268" title="Direct link to heading">#</a></h4><p>Pour que le bon template twig soit utilisÃ© il faut faire Ã§a :
<code>https://www.drupal.org/files/issues/2888268-8-views-link-doesnt-use-twig.patch</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="requetes-sql-de-stats"></a>REQUETES SQL DE STATS<a class="hash-link" href="#requetes-sql-de-stats" title="Direct link to heading">#</a></h4><p>Les likes</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  SELECT distinct nf.title, fc.count FROM flag_counts as fc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join flagging as f on fc.entity_id = f.entity_id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join node as n on fc.entity_id = n.nid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join node_field_data as nf on nf.vid = n.vid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  where f.flag_id = &quot;like&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  order by count desc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="site-settings"></a>Site settings<a class="hash-link" href="#site-settings" title="Direct link to heading">#</a></h3><p><a href="https://www.drupal.org/project/site_settings" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/site_settings</a></p><p>CrÃ©er les configurations dont vous avez besoin.
Aller dans Manage Site setting pour crÃ©er vos Ã©lÃ©ments
Aller dans site settings pour renseigner vos Ã©lÃ©ments</p><p>Pour les appeler depuis Twig:
Si vous avez plusieurs champs :
``` {{ site_settings.group_name.site_setting_name.field_name }} ````</p><p>Si vous avez un seul champ :
<code>{{ site_settings.group_name.site_setting_name }}</code></p><p>Si vous avez une seule variable avec plusieurs champs
<code>{{ site_settings.your_settings_group.your_setting_name.field_title }} </code>
<code>{{ site_settings.your_settings_group.your_setting_name.field_subtitle }}</code></p><p>Si vous avez une seule variable avec plusieurs champs et des champs complexes
<code>{{ site_settings.your_settings_group.your_setting_name.field_date.value }}</code>
<code>{{ site_settings.your_settings_group.your_setting_name.field_date.options }}</code></p><p>Il semble qu&#x27;un bug dans site_settings empÃªche d&#x27;utiliser les entity reference normalement. Cela ne retient que l&#x27;id de l&#x27;entity reference. Il faut donc utiliser twig tweak :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ drupal_entity(&#x27;media&#x27;, site_settings.theme.popup_teaser.field_video, &#x27;popup&#x27;) }}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>De plus, pour un lien, voici comment gÃ©nÃ©rer l&#x27;url dans twig, qu&#x27;elle soit interne ou externe :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% if site_settings.theme.popup_teaser.field_bouton.url.isExternal() %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% set uri = file_url(site_settings.theme.popup_teaser.field_bouton.uri) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% else %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% set uri = path(&#x27;entity.node.canonical&#x27;, {&#x27;node&#x27;: site_settings.theme.popup_teaser.field_bouton.url.getRouteParameters()[&#x27;node&#x27;]}) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endif %}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p>NB : S&#x27;il s&#x27;agit d&#x27;un site settings avec plusieurs champs, il faut que tous les champs soient alimentÃ©s pour qu&#x27;ils s&#x27;affichent en front</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="hierarchical_term_formatter"></a>hierarchical_term_formatter<a class="hash-link" href="#hierarchical_term_formatter" title="Direct link to heading">#</a></h3><p><a href="https://www.drupal.org/project/hierarchical_term_formatter" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/hierarchical_term_formatter</a></p><p>Ce module permet d&#x27;afficher une taxonomie ainsi que ses parents dans une hiÃ©rarchie.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="taxonomy_menu"></a>taxonomy_menu<a class="hash-link" href="#taxonomy_menu" title="Direct link to heading">#</a></h3><p>Ce module permet de crÃ©er un menu Ã  partir d&#x27;une taxonomy.</p><blockquote><p>NB : Pour pouvoir ordonner les termes en drag and drop Ã  partir de la taxonomie concernÃ©e, il faut cocher la case &quot;Use term weight order&quot; dans la configuration de Taxonomy menu</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="maestro--business-process-workflow"></a>Maestro : business process workflow<a class="hash-link" href="#maestro--business-process-workflow" title="Direct link to heading">#</a></h3><ol><li>Install all the Maestro module :</li></ol><ul><li>Maestro Engine Module,</li><li>Maestro Task Console,</li><li>Maestro Template Builder,</li><li>Maestro Utility Functions,</li><li>Maestro Webform Integration</li></ul><ol start="2"><li>In the Engine module (/admin/config/workflow/maestro) :</li></ol><ul><li>Create a Token that allows to run the orchestrator</li></ul><ol start="3"><li>In the template builder (maestro/templates/list):</li></ol><ul><li>Build the template by adding tasks from the starting point to the ending point of the process</li><li>In the edit template option, set the number of stage to show in the process timeline</li><li>In the task settings<ul><li>set the workflow stage number of the task in the process</li><li>set Unique identifier = submission</li><li>in the dropdown menu Webform select the concerned webform</li><li>in the assignment details, select the concerned role (or user)</li></ul></li></ul><ol start="4"><li>In the webform settings :</li></ol><ul><li>Add a Spawn Maestro Workflow handler</li><li>In Maestro Workflow Template, select the process created in step 3</li><li>Add an email handler to configure the user email notification :<ul><li>In the edit panel, select &quot;current user&quot; in the To email field</li></ul></li><li>Add an email handler to configure the manager email notification :<ul><li>If the email is related to a select of the form, choose the concerned field in the To email list, and set the email adress.</li></ul></li><li>For fields dedicated to manager, select the acces rights in the access tab.</li><li>champ disabled = settings / form display -&gt; dÃ©sactivÃ©</li><li>champ valeur par dÃ©faut = settings / avancÃ©</li><li>Draft -&gt; in the settings webform / paramÃ¨tres / submission : admin/structure/webform/manage/form_demat/settings/submissions</li><li>Download PDF<ul><li>Activer les modules Weform Webform Entity Print (PDF) et Webform Entity Print (PDF) Attachment</li><li>Activer le tÃ©lÃ©chargement sur le webform admin/structure/webform/manage/form_demat/results/download</li><li>config <a href="https://youtu.be/Zj1HQNGTHFI" target="_blank" rel="noopener noreferrer">https://youtu.be/Zj1HQNGTHFI</a></li><li>Si erreur aprÃ¨s installation des modules, rÃ©parer la config /admin/structure/webform/config/advanced</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rgpd--tarte-au-citron"></a>RGPD : Tarte au citron<a class="hash-link" href="#rgpd--tarte-au-citron" title="Direct link to heading">#</a></h3><ol><li>TÃ©lÃ©charger le module : <a href="https://opt-out.ferank.eu/fr/install/" target="_blank" rel="noopener noreferrer">https://opt-out.ferank.eu/fr/install/</a></li><li>Poser les sources dans le dossiers des assets du site</li><li>Coller le <code>&lt;script&gt;</code> dans le head (mettre Ã  jour si nÃ©cessaire le path vers le .js) :</li></ol><ul><li>Mettre le lien vers la page de politique de cookies<ul><li>&quot;privacyUrl&quot;: &quot;/{{directory}}/charte-de-confidentialite&quot;</li></ul></li><li>Pour remplacer la pastille par dÃ©faut par un lien (dans footer par exemple) :<ul><li>&quot;showAlertSmall&quot;: false</li></ul></li><li>Pour dÃ©sactiver l&#x27;auto consent<ul><li>&quot;highPrivacy&quot;: true</li><li><code>&lt;a href=&quot;#&quot; onclick=&quot;tarteaucitron.userInterface.openPanel();&quot;&gt;GESTION DES COOKIES&lt;/a&gt;</code></li></ul></li></ul><ol start="4"><li>SÃ©lectionner le(s) service(s) sur le site <a href="https://opt-out.ferank.eu/fr/install/" target="_blank" rel="noopener noreferrer">https://opt-out.ferank.eu/fr/install/</a> (Ã©tape 3)</li><li>Copier le code dans le body</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="store-locator"></a>Store Locator<a class="hash-link" href="#store-locator" title="Direct link to heading">#</a></h3><ol><li>Modules :<ul><li>Geolocation Field : &quot;<a href="https://www.drupal.org/project/geolocation%22" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/geolocation&quot;</a></li><li>Geocoder : &quot;<a href="https://www.drupal.org/project/geocoder%22" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/geocoder&quot;</a></li></ul></li><li>Configuration :<ul><li>Create a Store content type</li><li>In your Store create an address field</li><li>In your Store create a geolocation field</li><li>Link these two links via geocoder using the provider that you want</li><li>Create a view that list your store content type filtered by proximity on location field (expose this filter if needed)</li></ul></li><li>Code :<ul><li>Use google map autocomplete library: <code>&lt;script type=&quot;text/javascript&quot; src=&quot;https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;libraries=places&quot;&gt;&lt;/script&gt;</code></li><li>Make your input autocomplete with this library.</li><li>In js use geolocate: <a href="https://www.googleapis.com/geolocation/v1/geolocate" target="_blank" rel="noopener noreferrer">https://www.googleapis.com/geolocation/v1/geolocate</a> and geocode: <a href="https://maps.googleapis.com/maps/api/geocode" target="_blank" rel="noopener noreferrer">https://maps.googleapis.com/maps/api/geocode</a> libraries.</li><li>If you want to search location from address you will transform the address into a lat-lng data with <a href="https://maps.googleapis.com/maps/api/geocode/" target="_blank" rel="noopener noreferrer">https://maps.googleapis.com/maps/api/geocode/</a></li><li>Then fill lat field and lng field with the data you fetched from this google API.</li><li>If you want to geolocate the user use <a href="https://www.googleapis.com/geolocation/v1/geolocate" target="_blank" rel="noopener noreferrer">https://www.googleapis.com/geolocation/v1/geolocate</a></li><li>Then fill lat field and lng field with the data you fetched from this google API.</li></ul></li><li>Example (cf. krug project: <a href="https://gitlab.com/abecms/moet-hennessy/krug" target="_blank" rel="noopener noreferrer">https://gitlab.com/abecms/moet-hennessy/krug</a>) :<ol><li>Configuration:<ul><li>activate geolocation + geolocation address + geocoder extensions.</li><li>install google map provider using composer.</li><li>In geocoder configuration link google map provider.</li></ul></li><li>Code (cf. <a href="https://developers.google.com/maps/documentation/geocoding" target="_blank" rel="noopener noreferrer">https://developers.google.com/maps/documentation/geocoding</a> /// <a href="https://developers.google.com/maps/documentation/geolocation" target="_blank" rel="noopener noreferrer">https://developers.google.com/maps/documentation/geolocation</a> /// <a href="https://developers.google.com/maps/documentation/javascript/places-autocomplete" target="_blank" rel="noopener noreferrer">https://developers.google.com/maps/documentation/javascript/places-autocomplete</a>):</li></ol></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$(&#x27;.js-form-item&#x27;).hide();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$(&#x27;#geolocate&#x27;).once().click(function(e) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    e.preventDefault();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $.post(`https://www.googleapis.com/geolocation/v1/geolocate?key=${gmapApiKey}`, function(data) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $(&#x27;#edit-lat&#x27;).val(data.location.lat);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $(&#x27;#edit-lng&#x27;).val(data.location.lng);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $(&#x27;#edit-submit-find-krug&#x27;).click();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function initializeAutocomplete() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var element = document.getElementById(&quot;address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (element) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var autocomplete = new google.maps.places.Autocomplete(element, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            types: [&quot;geocode&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        google.maps.event.addListener(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            autocomplete,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;place_changed&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${autocomplete.getPlace().formatted_address.replace(&quot; &quot;, &quot;+&quot;)}&amp;key=${gmapApiKey}`, function(data) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                console.log(&#x27;result&#x27;, data.results[0].geometry.location);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                $(&#x27;#edit-lat&#x27;).val(data.results[0].geometry.location.lat);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                $(&#x27;#edit-lng&#x27;).val(data.results[0].geometry.location.lng);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">google.maps.event.addDomListener(window, &quot;load&quot;, function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    initializeAutocomplete();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="shield"></a>Shield<a class="hash-link" href="#shield" title="Direct link to heading">#</a></h3><ul><li>Attention si le module du core HTTP BASIC AUTHENTICATION il rentre en conflit avec shield.
Solution :</li><li>Installer a derniÃ¨re version de shield <code>composer require &#x27;drupal/shield:^1.3&#x27;</code></li><li>Appliquer  le patch ci-dessous patch <code>https://www.drupal.org/files/issues/2019-09-20/2815945-shield-1.3-rc1_basic_auth_compatibility-40.patch</code>:</li></ul><p>Methode pour appliquer le patch <a href="https://github.com/abecms/book-drupal8/blob/master/dev.md#patches" target="_blank" rel="noopener noreferrer">title</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="commerce"></a>Commerce<a class="hash-link" href="#commerce" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configurer-une-variation-de-produit"></a>Configurer une variation de produit<a class="hash-link" href="#configurer-une-variation-de-produit" title="Direct link to heading">#</a></h4><ul><li>aller sous /admin/commerce/config/product-variation-types</li><li>ajouter les champs nÃ©cessaires (image, ...)</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="paiement-cb"></a>Paiement CB<a class="hash-link" href="#paiement-cb" title="Direct link to heading">#</a></h4><ul><li>Pour conserver les infos CB : Saisir une phrase dans &quot;Alias usage&quot; pour afficher la case Ã  cocher sur la page ingenico</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="view-mode-page"></a>View Mode Page<a class="hash-link" href="#view-mode-page" title="Direct link to heading">#</a></h3><p>Create separate pages for different view modes for a given content type. For example use this module if you need to have 2 differents urls for a same media content type :</p><ul><li>One url that display the whole node</li><li>One url that display only the player (for embedding)</li></ul><p><a href="https://www.drupal.org/project/view_mode_page" target="_blank" rel="noopener noreferrer">https://www.drupal.org/project/view_mode_page</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="custom"></a>Custom<a class="hash-link" href="#custom" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="instagram"></a>Instagram<a class="hash-link" href="#instagram" title="Direct link to heading">#</a></h3><ol><li>DÃ©veloppement d&#x27;un module instagram.</li><li><a href="https://rudrastyh.com/javascript/get-photos-from-instagram.html#tags" target="_blank" rel="noopener noreferrer">https://rudrastyh.com/javascript/get-photos-from-instagram.html#tags</a> pour la crÃ©ation du token</li><li>find user id : <a href="https://smashballoon.com/instagram-feed/find-instagram-user-id" target="_blank" rel="noopener noreferrer">https://smashballoon.com/instagram-feed/find-instagram-user-id</a></li><li>CrÃ©er la rÃ©gion home_instagram dans theme.info.yml</li><li>Placer le block dans la rÃ©gion home_instagram</li><li>Dans configuration, mettre le token et les username souhaitÃ©s</li><li>ajout du template block--instagramblock.html.twig dans themes/custom/h1765/templates/block</li><li>ajout du template instagram-block-image.html.twig dans themes/custom/h1765/templates/block
ATTENTION: En mode sandbox de l&#x27;app Instagram, le plugin ne peut Ãªtre utilisÃ© car la recherche sur username ne fonctionne pas.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="view_filter"></a>view_filter<a class="hash-link" href="#view_filter" title="Direct link to heading">#</a></h3><p>Ce module permet de customiser les filtres des formulaires des vues.</p><p>Pour crÃ©er un template spÃ©cifique, il suffit de crÃ©er cette fonction dans un module:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function view_filter_theme()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;view_filter_input&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;variables&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;attributes&#x27; =&gt; [],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Ensuite, pour utiliser les variables dÃ©finies dans le template, il suffit d&#x27;utiliser le &#x27;#&#x27; (ici ca donne #attributes):</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$form[$attributeId.&#x27;-links&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;#theme&#x27; =&gt; &#x27;view_filter_input&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;#attributes&#x27; =&gt; array(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;class&#x27; =&gt; array(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;cp-sticky-bar__list-dropdown&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;dropdown-default&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;id&#x27; =&gt; $attributeId.&#x27;-pop&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Et ne pas oublier de crÃ©er le template view_filter_input.html.twig dans le rÃ©pertoire &#x27;templates&#x27; du module.</p><p>On peut dÃ©finir aussi des templates dans le theme qu&#x27;on crÃ©e (par exemple pour h1765.theme):</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function h1765_theme()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Register the theme mymodule_hello_name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;mymodule_hello_name&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;variables&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;name&#x27; =&gt; FALSE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="simplenews_ajax"></a>simplenews_ajax<a class="hash-link" href="#simplenews_ajax" title="Direct link to heading">#</a></h3><p>Ce module permet de complÃ©ter simplenewsajax. Il permet de rendre une soumission de formulaire en ajax :</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function simplenewsajax_form_alter(&amp;$form, FormStateInterface $form_state, $form_id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if (substr( $form_id, 0, 30 ) === &quot;simplenews_subscriptions_block&quot;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $form[&#x27;submit&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#type&#x27; =&gt; &#x27;submit&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#value&#x27; =&gt; &#x27;Submit&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#weight&#x27; =&gt; 6,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#id&#x27; =&gt; &#x27;edit-subscribe-ajax&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#ajax&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;callback&#x27; =&gt; &#x27;\Drupal\simplenewsajax\Controller\ConfirmationController::ajaxconfirmSubscription&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;wrapper&#x27; =&gt; &#x27;edit-mail-0-result&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;method&#x27; =&gt; &#x27;replace&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $form[&#x27;submit&#x27;][&#x27;#executes_submit_callback&#x27;] = TRUE;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;#submit&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;actions&#x27;][&#x27;subscribe&#x27;][&#x27;#submit&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;#validate&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="facebook_feeds_block"></a>facebook_feeds_block<a class="hash-link" href="#facebook_feeds_block" title="Direct link to heading">#</a></h3><p>Affichage des feeds FB via un bloc.</p><p>Pour obtenir un access de page token  : <a href="https://elfsight.com/blog/2017/10/how-to-get-facebook-access-token/" target="_blank" rel="noopener noreferrer">https://elfsight.com/blog/2017/10/how-to-get-facebook-access-token/</a> Dans le cas de ce block, il faut le page access token.</p><p>La solution pour obtenir un jeton qui dure toujours :
Here&#x27;s my solution using only Graph API Explorer &amp; Access Token Debugger:</p><ul><li>Graph API Explorer:</li><li>Select your App from the top right dropdown menu</li><li>Select &quot;Get User Access Token&quot; from dropdown (right of access token field) and select needed permissions</li><li>Copy user access token</li><li>Access Token Debugger:</li><li>Paste copied token and press &quot;Debug&quot;</li><li>Press &quot;Extend Access Token&quot; and copy the generated long-lived user access token</li><li>Graph API Explorer:</li><li>Paste copied token into the &quot;Access Token&quot; field</li><li>Make a GET request with &quot;PAGE_ID?fields=access_token&quot;</li><li>Find the permanent page access token in the response (node &quot;access_token&quot;)</li><li>(Optional) Access Token Debugger:</li><li>Paste the permanent token and press &quot;Debug&quot;</li><li>&quot;Expires&quot; should be &quot;Never&quot;</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="view-unpublished"></a>view unpublished<a class="hash-link" href="#view-unpublished" title="Direct link to heading">#</a></h3><p>Lorsque des droits restreints sont appliquÃ©s sur des types de contenus pour un rÃ´le donnÃ©, les contenus unpublished ne sont pas visibles de ce rÃ´le. L&#x27;installation du module view_unpublished permet d&#x27;appliquer les droits de &quot;voir les contenus non publiÃ©s&quot; pour chaque type de contenu (voir &quot;view unpublished&quot; dans admin/people/permissions).
Une fois installÃ©, il est nÃ©cessaire de recalculer les droits (un message apparaitra en BO).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="robot"></a>Robot<a class="hash-link" href="#robot" title="Direct link to heading">#</a></h3><p>Afin de dÃ©finir la valeur du fichier robots.txt installer le module &quot;RobotsTxt&quot;.
A noter : Il est nÃ©cessaire de supprimer (ou renommer) le fichier robots.txt dÃ©jÃ  prÃ©sent pour que le module affiche son propre robots.txt</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="views-reference-field"></a>Views Reference Field<a class="hash-link" href="#views-reference-field" title="Direct link to heading">#</a></h3><p>Ce module permet de rÃ©fÃ©rencer une vue dans le champs d&#x27;un node. Une fois installÃ© :</p><ol><li>CrÃ©er la vue</li><li>CrÃ©er un nouveau champ dans le contenu concernÃ©</li></ol><ul><li>Type de champ = views reference</li><li>Type d&#x27;Ã©lÃ©ment Ã  rÃ©fÃ©rencer = vue</li><li>View display plugins to allow = bloc</li><li>Preselect View Options = SÃ©lectionner la vue crÃ©er Ã  l&#x27;Ã©tape 1</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="nodeaccess"></a>Nodeaccess<a class="hash-link" href="#nodeaccess" title="Direct link to heading">#</a></h3><p>Ce module permet de sÃ©curiser l&#x27;accÃ¨s Ã  un node.
<a href="https://www.drupal.org/project/nodeaccess" target="_blank" rel="noopener noreferrer">nodeaccess</a>
Voir <a href="/docs/dynamisation/nodes#acces-sp%C3%A9cifique-%C3%A0-la-modification-dun-node">nodes</a>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/dynamisation/ckeditor"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ckeditor</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/dynamisation/domains"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">domains Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core" class="table-of-contents__link">Core</a><ul><li><a href="#statistics" class="table-of-contents__link">statistics</a></li></ul></li><li><a href="#contrib" class="table-of-contents__link">Contrib</a><ul><li><a href="#install-and-activate-a-contrib-module" class="table-of-contents__link">Install and activate a contrib module</a></li><li><a href="#ajax-loader" class="table-of-contents__link">Ajax loader</a></li><li><a href="#color-field" class="table-of-contents__link">color field</a></li><li><a href="#cookieconsent" class="table-of-contents__link">cookieconsent</a></li><li><a href="#simple-popup-blocks" class="table-of-contents__link">simple popup blocks</a></li><li><a href="#simplenews" class="table-of-contents__link">Simplenews</a></li><li><a href="#pathauto" class="table-of-contents__link">Pathauto</a></li><li><a href="#metatag" class="table-of-contents__link">Metatag</a></li><li><a href="#elasticsearch" class="table-of-contents__link">ElasticSearch</a></li><li><a href="#videos-transcoding" class="table-of-contents__link">Videos transcoding</a></li><li><a href="#redis" class="table-of-contents__link">Redis</a></li><li><a href="#webform" class="table-of-contents__link">Webform</a></li><li><a href="#webform-recaptcha" class="table-of-contents__link">Webform recaptcha</a></li><li><a href="#datalayer" class="table-of-contents__link">Datalayer</a></li><li><a href="#amp" class="table-of-contents__link">AMP</a></li><li><a href="#flag" class="table-of-contents__link">flag</a></li><li><a href="#site-settings" class="table-of-contents__link">Site settings</a></li><li><a href="#hierarchical_term_formatter" class="table-of-contents__link">hierarchical_term_formatter</a></li><li><a href="#taxonomy_menu" class="table-of-contents__link">taxonomy_menu</a></li><li><a href="#maestro--business-process-workflow" class="table-of-contents__link">Maestro : business process workflow</a></li><li><a href="#rgpd--tarte-au-citron" class="table-of-contents__link">RGPD : Tarte au citron</a></li><li><a href="#store-locator" class="table-of-contents__link">Store Locator</a></li><li><a href="#shield" class="table-of-contents__link">Shield</a></li><li><a href="#commerce" class="table-of-contents__link">Commerce</a></li><li><a href="#view-mode-page" class="table-of-contents__link">View Mode Page</a></li></ul></li><li><a href="#custom" class="table-of-contents__link">Custom</a><ul><li><a href="#instagram" class="table-of-contents__link">Instagram</a></li><li><a href="#view_filter" class="table-of-contents__link">view_filter</a></li><li><a href="#simplenews_ajax" class="table-of-contents__link">simplenews_ajax</a></li><li><a href="#facebook_feeds_block" class="table-of-contents__link">facebook_feeds_block</a></li><li><a href="#view-unpublished" class="table-of-contents__link">view unpublished</a></li><li><a href="#robot" class="table-of-contents__link">Robot</a></li><li><a href="#views-reference-field" class="table-of-contents__link">Views Reference Field</a></li><li><a href="#nodeaccess" class="table-of-contents__link">Nodeaccess</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/setup/introduction">Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://abecms.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Website</h4><ul class="footer__items"><li class="footer__item"><a href="https://livingcolor.fr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="https://docusaurus.io/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright Â© 2021 Abe SAS. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.dd3b91b9.js"></script>
<script src="/runtime~main.089246bf.js"></script>
<script src="/main.901730ae.js"></script>
<script src="/1.610b12b6.js"></script>
<script src="/2.2611d948.js"></script>
<script src="/41.ff57316b.js"></script>
<script src="/44.23577ab9.js"></script>
<script src="/935f2afb.70e75e8c.js"></script>
<script src="/17896441.ea08961a.js"></script>
<script src="/3db804d2.db1c895f.js"></script>
</body>
</html>