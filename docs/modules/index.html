<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">

<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"17896441":["/book-drupal17896441.a4bc64a1.js"],"main":["/book-drupalmain.9c2c4e27.js"],"0e800433":["/book-drupal0e800433.2a42d23d.js"],"1b017fc8":["/book-drupal1b017fc8.c58a1f3a.js"],"1be78505":[],"23d28cd9":["/book-drupal23d28cd9.a5842da9.js"],"3847b3ea":["/book-drupal3847b3ea.fa32d97a.js"],"3f607676":["/book-drupal3f607676.bde67b4a.js"],"42b7455d":["/book-drupal42b7455d.1b365b3c.js"],"4cc4d2ba":["/book-drupal4cc4d2ba.b50dce5e.js"],"5caa2f80":["/book-drupal5caa2f80.627b9231.js"],"605b7772":["/book-drupal605b7772.a78d99be.js"],"645d743a":["/book-drupal645d743a.9f75881c.js"],"683be167":["/book-drupal683be167.97a90862.js"],"6aeeabde":["/book-drupal6aeeabde.895d1235.js"],"7047bd09":["/book-drupal7047bd09.9cd9bd14.js"],"816165d5":["/book-drupal816165d5.028a4f23.js"],"950718c7":["/book-drupal950718c7.24bbad45.js"],"9ed00105":["/book-drupal9ed00105.af3fcaf9.js"],"a09c2993":["/book-drupala09c2993.d1b47299.js"],"a303f551":["/book-drupala303f551.3aac3db4.js"],"c4f5d8e4":["/book-drupalc4f5d8e4.57dbb819.js"],"ce3e42ad":["/book-drupalce3e42ad.621a39b8.js"],"d59a3898":["/book-drupald59a3898.3cf8b081.js"],"febdf506":["/book-drupalfebdf506.29d85768.js"]};/*]]>*/</script>

<title data-react-helmet="true">modules</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" property="og:title" content="Drupal Stickers Book · Build a Drupal website in no time !"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="description" content="# Modules"/><meta data-react-helmet="true" property="og:description" content="# Modules"/><meta data-react-helmet="true" property="og:url" content="https://abecms.github.io/book-drupal/docs/modules"/>

<link data-react-helmet="true" rel="shortcut icon" href="/book-drupalimg/logo-white.png"/>


<link rel="stylesheet" type="text/css" href="/book-drupalstyles.fcdbc45b.css" />

</head>
<body >
<script type="text/javascript">(function() {
  function setDataThemeAttribute(theme) {
    document.querySelector('html').setAttribute('data-theme', theme);
  }
  
  var preferDarkQuery = '(prefers-color-scheme: dark)';
  var mql = window.matchMedia(preferDarkQuery);
  var supportsColorSchemeQuery = mql.media === preferDarkQuery;
  var localStorageTheme = null;
  try {
    localStorageTheme = localStorage.getItem('theme');
  } catch (err) {}
  var localStorageExists = localStorageTheme !== null;

  if (localStorageExists) {
    setDataThemeAttribute(localStorageTheme);
  } else if (supportsColorSchemeQuery && mql.matches) {
    setDataThemeAttribute('dark');
  }
})();</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/book-drupal"><img class="navbar__logo" src="/book-drupalimg/logo.png" alt="livingcolor"/><strong class="">Drupal Stickers Recipes</strong></a><a class="navbar__item navbar__link" href="/book-drupaldocs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/book-drupal"><img class="navbar__logo" src="/book-drupalimg/logo.png" alt="livingcolor"/><strong>Drupal Stickers Recipes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/book-drupaldocs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/introduction">introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/setup">setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/configuration">configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/tests">tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Dynamisation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/nodes">nodes</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/paragraphs">paragraphs</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/views">views</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/forms">forms</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/taxonomies">taxonomies</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/tokens">tokens</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/images">images</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/users">users</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/comments">comments</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/newsletters">newsletters</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/menus">menus</a></li><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/ckeditor">ckeditor</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/book-drupal/docs/modules">modules</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dev specific</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/book-drupal/docs/dev">dev</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">modules</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="modules"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#modules" title="Direct link to heading">#</a>Modules</h1><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="core"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#core" title="Direct link to heading">#</a>Core</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="statistics"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#statistics" title="Direct link to heading">#</a>statistics</h3><p>Un patch a été créé pour le projet &quot;Consommateurs &amp; Citoyen&quot;. Ce patch permet de réaliser des stats sur toutes les entités et pas seulement les nodes. De plus, l&#x27;appel ajax d&#x27;incrémentation de la vue renvoie le compte de l&#x27;entité.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="contrib"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#contrib" title="Direct link to heading">#</a>Contrib</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="cookieconsent"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cookieconsent" title="Direct link to heading">#</a>cookieconsent</h3><ol><li>Installer le module Cookie consent  (<a href="https://www.drupal.org/project/cookieconsent">https://www.drupal.org/project/cookieconsent</a>)</li><li>Configurer les donnée de personnalisation (texte, lien vers la page de consentement, css)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="simple-popup-blocks"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#simple-popup-blocks" title="Direct link to heading">#</a>simple popup blocks</h3><ol><li>Installer le module simple popup blocks  (<a href="https://www.drupal.org/project/simple_popup_blocks">https://www.drupal.org/project/simple_popup_blocks</a>)
Permet de créer des popin à partir de n&#x27;importe quel contenu (même les formulaires)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="simplenews"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#simplenews" title="Direct link to heading">#</a>Simplenews</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ajouter-une-vue-sur-la-newsletter"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#ajouter-une-vue-sur-la-newsletter" title="Direct link to heading">#</a>Ajouter une vue sur la newsletter</h4><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function YOURTHEME_preprocess_simplenews_newsletter_body(&amp;$variables) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$variables[&#x27;latestnews&#x27;] = views_embed_view(&#x27;latestnews&#x27;, &#x27;block_1&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Create a template for the newsletter body simplenews-newsletter-body--<!-- -->[newsletter_id]<!-- -->.html.twig (newsletter_id = machine name). and add your view in it where you&#x27;d like to:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ latestnews }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="configurer-simplenews"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configurer-simplenews" title="Direct link to heading">#</a>configurer simplenews</h4><ul><li>installer simplenews et swiftmailer</li><li>Créer mytheme/templates/swiftmailer.html.twig et set mailsystem to use mytheme to render the emails.</li><li>set mailsystem to use swiftmailers default formatter plugin</li><li>set mailsystem to use swiftmailers default sender plugin</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="metatag"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#metatag" title="Direct link to heading">#</a>Metatag</h3><ul><li>Installer le module metatag</li><li>Pour personnaliser un node, il suffit de créer un nouveau champ de type metatag. Automatiquement, il permettra de personnaliser les meta sur chaque node</li><li>pour placer l&#x27;image issue d&#x27;un champ du node qui est contenue dans un media : <code>[node:field_visuel:entity:field_media_image:entity:url]</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="elasticsearch"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#elasticsearch" title="Direct link to heading">#</a>ElasticSearch</h3><p>Note: <code>http://letstoob.info/drupal-8/how-to-integrate-elasticsearch-6-3-0-with-drupal-8-5/</code></p><p>2 modules necessaires:</p><ul><li>Elasticsearch connector - <code>https://www.drupal.org/project/elasticsearch_connector</code></li><li>Search Api - <code>https://www.drupal.org/project/search_api</code></li></ul><ol><li>Go to <code>admin/config/search/elasticsearch-connector</code></li><li>Click on ```Add Cluster````</li><li>Fill in <code>name</code> and URL <code>http://localhost:9200</code> ou <code>http://nameofthedocker:9200</code> if you use a docker elastic</li><li>Select <code>Select this cluster default connection</code></li><li>Select <code>Use multiple nodes connection</code></li><li>Click <code>save</code></li><li></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="videos-transcoding"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#videos-transcoding" title="Direct link to heading">#</a>Videos transcoding</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="cloudstack-trancoding"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cloudstack-trancoding" title="Direct link to heading">#</a>Cloudstack Trancoding</h4><p><code>https://aws.amazon.com/blogs/networking-and-content-delivery/serverless-video-on-demand-vod-workflow/</code></p><ul><li>If your s3 bucket is in north US-EAST (N. Virginia)</li><li>You need to apply this patch for s3fs_cors module for drupal cause this is the only region need to be http called without the region in URL</li><li><code>https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html#access-bucket-intro</code></li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-php codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">diff </span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token plain">git a</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">contrib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">s3fs_cors</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">Element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">S3fsCorsFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">php b</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">contrib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">s3fs_cors</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">Element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">S3fsCorsFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">index </span><span class="token number" style="color:rgb(247, 140, 108)">5902592</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token number" style="color:rgb(247, 140, 108)">.99616251</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100644</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">contrib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">s3fs_cors</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">Element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">S3fsCorsFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">contrib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">s3fs_cors</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">Element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">S3fsCorsFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@@ </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">231</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">231</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain"> @@ </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">processManagedFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token variable" style="color:rgb(191, 199, 213)">$element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> FormStateInterface </span><span class="token variable" style="color:rgb(191, 199, 213)">$form_st</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Pass the element parents through to the javascript function.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token variable" style="color:rgb(191, 199, 213)">$js_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;element_parents&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">implode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$element_parents</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$js_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;cors_form_action&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$cors_config</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;s3fs_https&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;://s3-&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;region&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;.amazonaws.com/&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$bucket</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$js_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;cors_form_action&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$cors_config</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;s3fs_https&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;://s3&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;.amazonaws.com/&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$bucket</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token variable" style="color:rgb(191, 199, 213)">$field_name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;#field_name&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token keyword" style="font-style:italic">empty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;#field_parents&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="cloudfront-and-s3-cors-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cloudfront-and-s3-cors-config" title="Direct link to heading">#</a>CloudFront and S3 CORS config</h4><p><code>https://stackoverflow.com/questions/50022326/amazon-s3-image-cors-issue</code></p><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="s3-cors-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#s3-cors-config" title="Direct link to heading">#</a>S3 CORS Config</h5><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-xml codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSConfiguration</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">xmlns</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://s3.amazonaws.com/doc/2006-03-01/</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">http://*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">https://*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">POST</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">MaxAgeSeconds</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">3000</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">MaxAgeSeconds</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">ExposeHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">x-amz-version-id</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">ExposeHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">GET</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedOrigin</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">HEAD</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedMethod</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">*</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">AllowedHeader</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSRule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CORSConfiguration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="cloudfront-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cloudfront-config" title="Direct link to heading">#</a>CloudFront Config</h5><p><code>https://stackoverflow.com/questions/50022326/amazon-s3-image-cors-issue</code></p><ul><li>Got to <code>Behaviors</code> tab</li><li>Select your distribution but ticking it and click on <code>Edit</code></li><li><code>Cache Based on Selected Request Headers</code> set to <code>Whitelist</code></li><li><code>Whitelist Headers</code> add <code>Access-Control-Request-Headers</code>, <code>Access-Control-Request-Method</code> and <code>Origin</code></li><li><code>Object Caching</code> tick <code>Use Origin Cache Headers</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="drupal-8-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#drupal-8-config" title="Direct link to heading">#</a>Drupal 8 Config</h4><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="modules-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#modules-1" title="Direct link to heading">#</a>Modules</h5><p>You&#x27;ll need 2 modules</p><ul><li><p>Run <code>composer require &#x27;drupal/s3fs:^3.0&#x27;</code></p></li><li><p>Run <code>composer require &#x27;drupal/s3fs_cors:^1.0&#x27;</code></p></li><li><p>You&#x27;ll need you AWS accesskey and secretkey</p></li><li><p>Edit your <code>settings.php</code></p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-php codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** S3 configuration security */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;s3fs.access_key&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;youraccesskey&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;s3fs.secret_key&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;yoursecretkey&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="drupal-admin-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#drupal-admin-config" title="Direct link to heading">#</a>Drupal admin config</h4><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="media-type"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#media-type" title="Direct link to heading">#</a>Media Type</h5><p>Structure &gt; Types de media &gt; Video &gt; Gérer les champs
or <code>admin/structure/media/manage/video/fields</code></p><ul><li>Vidéo file &gt; modifier</li><li>Repertoire du fichier must be <code>input</code></li><li>Paramètres du champs pick <code>S3 File System</code></li></ul><p><code>admin/structure/media/manage/video/form-display</code></p><ul><li>for <code>Video file</code> pick <code>S3fs Cors File Upload</code></li><li>Click on the toothed wheel to setup the FileSize Limit</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="s3-config"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#s3-config" title="Direct link to heading">#</a>S3 Config</h5><p>Go to <code>https://yourdrupalsite/admin/config/media/s3fs</code></p><ul><li>Fill your bucket previsouly created from AWS cloudstack</li><li>Tick ```Always serve files from S3 via HTTPS````</li></ul><p>Go to <code>admin/config/media/s3fs/cors</code></p><ul><li>tick <code>https</code> for <code>Use Https/Http</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="redis"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#redis" title="Direct link to heading">#</a>Redis</h3><p>Module Install - <code>https://www.drupal.org/project/redis</code>
1. Run <code>composer require &#x27;drupal/redis:^1.1&#x27;</code> in docroot
1. Activate module in Back Office
1. Clear the cache
1. Update <code>settings.php</code> with</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Redis Configuration.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;host&#x27;] =  &#x27;redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;port&#x27;] = NULL;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;cache&#x27;][&#x27;default&#x27;] = &#x27;cache.backend.redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$settings[&#x27;redis.connection&#x27;][&#x27;base&#x27;] = 8;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $conf[&#x27;chq_redis_cache_enabled&#x27;] = TRUE;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (isset($conf[&#x27;chq_redis_cache_enabled&#x27;]) &amp;&amp; $conf[&#x27;chq_redis_cache_enabled&#x27;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $settings[&#x27;redis.connection&#x27;][&#x27;interface&#x27;] = &#x27;PhpRedis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $settings[&#x27;cache&#x27;][&#x27;default&#x27;] = &#x27;cache.backend.redis&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Note that unlike memcached, redis persists cache items to disk so we can</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // actually store cache_class_cache_form in the default cache.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $conf[&#x27;cache_class_cache&#x27;] = &#x27;Redis_Cache&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="webform"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#webform" title="Direct link to heading">#</a>Webform</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="webform-children"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#webform-children" title="Direct link to heading">#</a>Webform children</h4><p>Les children de webform sont en fait des contenus déjà préparés. On ne peut donc pas faire de <code>{{for child in children</code></p><p>Pour remplacer, ajouter, supprimer une classe par ex. il suffit juste d&#x27;utiliser la fonction replace de twig !</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ children | replace({&#x27;webform-flex &#x27;: &quot;webform-flex form__section &quot;}) | raw }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="conditionner-email-destinataire-selon-options-liste-déroulante"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#conditionner-email-destinataire-selon-options-liste-déroulante" title="Direct link to heading">#</a>Conditionner email destinataire selon options liste déroulante</h4><ol><li>Structure webform : Créer un formulaire ou modifier le formulaire concerné</li><li>Tab construire : ajouter un champ &quot;liste de selection&quot; et saisir les différentes options</li><li>Tab Handler :</li></ol><ul><li>Ajouter un handler,</li><li>Dans &quot;Envoyer A&quot;, sélectionner la liste créer dans le formulaire</li><li>Pour chaque entrée de la liste saisir le destinataire concerné</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="webform-recaptcha"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#webform-recaptcha" title="Direct link to heading">#</a>Webform recaptcha</h3><ol><li>Installer les modules Captcha et reCaptcha (<a href="https://www.drupal.org/project/recaptcha">https://www.drupal.org/project/recaptcha</a>)</li><li>Aller dans configuration/personnes/Captcha et configurer Captcha et reCaptcha : Bien créer un reCaptcha Google avec les bonnes clés et autorisant les bons domaines.</li><li>Aller dans le modèle du webform et ajouter un champ de type reCaptcha. Enjoy !</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="datalayer"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#datalayer" title="Direct link to heading">#</a>Datalayer</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="bug-lors-de-la-suppresion-dun-inscrit-newsletter-via-simplenews"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#bug-lors-de-la-suppresion-dun-inscrit-newsletter-via-simplenews" title="Direct link to heading">#</a>Bug lors de la suppresion d&#x27;un inscrit newsletter (via simplenews)</h4><p>attention patch à faire (manuel) sur datalayer.module pour éviter un message d&#x27;erreur sur la suppression d&#x27;un inscrit newsletter (ligne 331) :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// For entities with an owner/author, get the username</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if ((empty($selected_properties) || array_key_exists(&#x27;name&#x27;, $properties))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;&amp; !isset($output_data[&#x27;entityName&#x27;]) &amp;&amp; is_object($entity-&gt;uid &amp;&amp; isset($entity-&gt;uid-&gt;entity-&gt;name))) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $output_data[&#x27;entityName&#x27;] = $entity-&gt;uid-&gt;entity-&gt;name-&gt;getString();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="amp"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#amp" title="Direct link to heading">#</a>AMP</h3><p>Permet de proposer la version AMP pour un node.
cf. <a href="https://www.drupal.org/docs/8/modules/accelerated-mobile-pages-amp/amp-version-82">https://www.drupal.org/docs/8/modules/accelerated-mobile-pages-amp/amp-version-82</a></p><p>Installer <code>composer require &#x27;drupal/schema_metatag:^1.3&#x27;</code> pour les micro-formats AMP</p><p>il y a actuellement un bug sur l&#x27;install de masterminds. Il faut faire :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">composer require drupal/amp masterminds/html5:~2.3.0</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="flag"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#flag" title="Direct link to heading">#</a>flag</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="créer-ses-propres-liens-de-bookmarks-par-le-user"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créer-ses-propres-liens-de-bookmarks-par-le-user" title="Direct link to heading">#</a>Créer ses propres liens de bookmarks par le user</h4><ul><li>utiliser le module flag et:</li></ul><ol><li>créer un type de block (ex. myOwnBookmarks)</li><li>Créer un block de ce type (utilisons aussi myOwnBookmarks comme nom)</li><li>Créer un flag (aussi myOwnBookmarks :) associé au type de bloc myOwnBookmarks.</li><li>Ajouter un champ link à ce flag (qu&#x27;on peut limiter à 10 répétitions par ex. dans la config)</li><li>demandons l&#x27;affichage du flag en form popin puis sauvegardons le flag</li><li>Si on affiche le bloc myOwnBookmarks dans une région, on aura l&#x27;affichage du flag. au clic, popin avec le fomulaire de saisie des links !</li><li>Il ne reste plus qu&#x27;à créer une vue qui affiche le contenu du flag, et à utiliser cette vue ou on veut.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="bug-dans-le-module--httpswwwdrupalorgprojectflagissues2888268"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#bug-dans-le-module--httpswwwdrupalorgprojectflagissues2888268" title="Direct link to heading">#</a>bug dans le module : <a href="https://www.drupal.org/project/flag/issues/2888268">https://www.drupal.org/project/flag/issues/2888268</a></h4><p>Pour que le bon template twig soit utilisé il faut faire ça :
<code>https://www.drupal.org/files/issues/2888268-8-views-link-doesnt-use-twig.patch</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="requetes-sql-de-stats"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#requetes-sql-de-stats" title="Direct link to heading">#</a>REQUETES SQL DE STATS</h4><p>Les likes</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SELECT distinct nf.title, fc.count FROM flag_counts as fc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join flagging as f on fc.entity_id = f.entity_id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join node as n on fc.entity_id = n.nid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  inner join node_field_data as nf on nf.vid = n.vid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  where f.flag_id = &quot;like&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  order by count desc</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="site-settings"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#site-settings" title="Direct link to heading">#</a>Site settings</h3><p><a href="https://www.drupal.org/project/site_settings">https://www.drupal.org/project/site_settings</a></p><p>Créer les configurations dont vous avez besoin.
Aller dans Manage Site setting pour créer vos éléments
Aller dans site settings pour renseigner vos éléments</p><p>Pour les appeler depuis Twig:
Si vous avez plusieurs champs :
``` {{ site_settings.group_name.site_setting_name.field_name }} ````</p><p>Si vous avez un seul champ :
<code>{{ site_settings.group_name.site_setting_name }}</code></p><p>Il semble qu&#x27;un bug dans site_settings empêche d&#x27;utiliser les entity reference normalement. Cela ne retient que l&#x27;id de l&#x27;entity reference. Il faut donc utiliser twig tweak :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ drupal_entity(&#x27;media&#x27;, site_settings.theme.popup_teaser.field_video, &#x27;popup&#x27;) }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>De plus, pour un lien, voici comment générer l&#x27;url dans twig, qu&#x27;elle soit interne ou externe :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% if site_settings.theme.popup_teaser.field_bouton.url.isExternal() %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% set uri = file_url(site_settings.theme.popup_teaser.field_bouton.uri) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% else %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% set uri = path(&#x27;entity.node.canonical&#x27;, {&#x27;node&#x27;: site_settings.theme.popup_teaser.field_bouton.url.getRouteParameters()[&#x27;node&#x27;]}) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endif %}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="hierarchical_term_formatter"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#hierarchical_term_formatter" title="Direct link to heading">#</a>hierarchical_term_formatter</h3><p><a href="https://www.drupal.org/project/hierarchical_term_formatter">https://www.drupal.org/project/hierarchical_term_formatter</a></p><p>Ce module permet d&#x27;afficher une taxonomie ainsi que ses parents dans une hiérarchie.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="taxonomy_menu"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#taxonomy_menu" title="Direct link to heading">#</a>taxonomy_menu</h3><p>Ce module permet de créer un menu à partir d&#x27;une taxonomy</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="maestro--business-process-workflow"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#maestro--business-process-workflow" title="Direct link to heading">#</a>Maestro : business process workflow</h3><ol><li>Install all the Maestro module :</li></ol><ul><li>Maestro Engine Module,</li><li>Maestro Task Console,</li><li>Maestro Template Builder,</li><li>Maestro Utility Functions,</li><li>Maestro Webform Integration</li></ul><ol start="2"><li>In the Engine module (/admin/config/workflow/maestro) :</li></ol><ul><li>Create a Token that allows to run the orchestrator</li></ul><ol start="3"><li>In the template builder (maestro/templates/list):</li></ol><ul><li>Build the template by adding tasks from the starting point to the ending point of the process</li><li>In the edit template option, set the number of stage to show in the process timeline</li><li>In the task settings<ul><li>set the workflow stage number of the task in the process</li><li>set Unique identifier = submission</li><li>in the dropdown menu Webform select the concerned webform</li><li>in the assignment details, select the concerned role (or user)</li></ul></li></ul><ol start="4"><li>In the webform settings :</li></ol><ul><li>Add a Spawn Maestro Workflow handler</li><li>In Maestro Workflow Template, select the process created in step 3</li><li>Add an email handler to configure the user email notification :<ul><li>In the edit panel, select &quot;current user&quot; in the To email field</li></ul></li><li>Add an email handler to configure the manager email notification :<ul><li>If the email is related to a select of the form, choose the concerned field in the To email list, and set the email adress.</li></ul></li><li>For fields dedicated to manager, select the acces rights in the access tab.</li><li>champ disabled = settings / form display -&gt; désactivé</li><li>champ valeur par défaut = settings / avancé</li><li>Draft -&gt; in the settings webform / paramètres / submission : admin/structure/webform/manage/form_demat/settings/submissions</li><li>Download PDF<ul><li>Activer les modules Weform Webform Entity Print (PDF) et Webform Entity Print (PDF) Attachment</li><li>Activer le téléchargement sur le webform admin/structure/webform/manage/form_demat/results/download</li><li>config <a href="https://youtu.be/Zj1HQNGTHFI">https://youtu.be/Zj1HQNGTHFI</a></li><li>Si erreur après installation des modules, réparer la config /admin/structure/webform/config/advanced</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="rgpd--tarte-au-citron"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#rgpd--tarte-au-citron" title="Direct link to heading">#</a>RGPD : Tarte au citron</h3><ol><li>Télécharger le module : <a href="https://opt-out.ferank.eu/fr/install/">https://opt-out.ferank.eu/fr/install/</a></li><li>Poser les sources dans le dossiers des assets du site</li><li>Coller le <code>&lt;script&gt;</code> dans le head (mettre à jour si nécessaire le path vers le .js) :</li></ol><ul><li>Mettre le lien vers la page de politique de cookies<ul><li>&quot;privacyUrl&quot;: &quot;/{{directory}}/charte-de-confidentialite&quot;</li></ul></li><li>Pour remplacer la pastille par défaut par un lien (dans footer par exemple) :<ul><li>&quot;showAlertSmall&quot;: false</li></ul></li><li>Pour désactiver l&#x27;auto consent<ul><li>&quot;highPrivacy&quot;: true</li><li><code>&lt;a href=&quot;#&quot; onclick=&quot;tarteaucitron.userInterface.openPanel();&quot;&gt;GESTION DES COOKIES&lt;/a&gt;</code></li></ul></li></ul><ol start="4"><li>Sélectionner le(s) service(s) sur le site <a href="https://opt-out.ferank.eu/fr/install/">https://opt-out.ferank.eu/fr/install/</a> (étape 3)</li><li>Copier le code dans le body</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="custom"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom" title="Direct link to heading">#</a>Custom</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="instagram"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#instagram" title="Direct link to heading">#</a>Instagram</h3><ol><li>Développement d&#x27;un module instagram.</li><li><a href="https://rudrastyh.com/javascript/get-photos-from-instagram.html#tags">https://rudrastyh.com/javascript/get-photos-from-instagram.html#tags</a> pour la création du token</li><li>find user id : <a href="https://smashballoon.com/instagram-feed/find-instagram-user-id">https://smashballoon.com/instagram-feed/find-instagram-user-id</a></li><li>Créer la région home_instagram dans theme.info.yml</li><li>Placer le block dans la région home_instagram</li><li>Dans configuration, mettre le token et les username souhaités</li><li>ajout du template block--instagramblock.html.twig dans themes/custom/h1765/templates/block</li><li>ajout du template instagram-block-image.html.twig dans themes/custom/h1765/templates/block
ATTENTION: En mode sandbox de l&#x27;app Instagram, le plugin ne peut être utilisé car la recherche sur username ne fonctionne pas.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="view_filter"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#view_filter" title="Direct link to heading">#</a>view_filter</h3><p>Ce module permet de customiser les filtres des formulaires des vues.</p><p>Pour créer un template spécifique, il suffit de créer cette fonction dans un module:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function view_filter_theme()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;view_filter_input&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;variables&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;attributes&#x27; =&gt; [],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Ensuite, pour utiliser les variables définies dans le template, il suffit d&#x27;utiliser le &#x27;#&#x27; (ici ca donne #attributes):</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$form[$attributeId.&#x27;-links&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;#theme&#x27; =&gt; &#x27;view_filter_input&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;#attributes&#x27; =&gt; array(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;class&#x27; =&gt; array(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;cp-sticky-bar__list-dropdown&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;dropdown-default&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;id&#x27; =&gt; $attributeId.&#x27;-pop&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">];</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Et ne pas oublier de créer le template view_filter_input.html.twig dans le répertoire &#x27;templates&#x27; du module.</p><p>On peut définir aussi des templates dans le theme qu&#x27;on crée (par exemple pour h1765.theme):</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function h1765_theme()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Register the theme mymodule_hello_name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;mymodule_hello_name&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;variables&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;name&#x27; =&gt; FALSE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="simplenews_ajax"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#simplenews_ajax" title="Direct link to heading">#</a>simplenews_ajax</h3><p>Ce module permet de compléter simplenewsajax. Il permet de rendre une soumission de formulaire en ajax :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function simplenewsajax_form_alter(&amp;$form, FormStateInterface $form_state, $form_id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if (substr( $form_id, 0, 30 ) === &quot;simplenews_subscriptions_block&quot;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $form[&#x27;submit&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#type&#x27; =&gt; &#x27;submit&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#value&#x27; =&gt; &#x27;Submit&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#weight&#x27; =&gt; 6,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#id&#x27; =&gt; &#x27;edit-subscribe-ajax&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;#ajax&#x27; =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;callback&#x27; =&gt; &#x27;\Drupal\simplenewsajax\Controller\ConfirmationController::ajaxconfirmSubscription&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;wrapper&#x27; =&gt; &#x27;edit-mail-0-result&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;method&#x27; =&gt; &#x27;replace&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $form[&#x27;submit&#x27;][&#x27;#executes_submit_callback&#x27;] = TRUE;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;#submit&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;actions&#x27;][&#x27;subscribe&#x27;][&#x27;#submit&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($form[&#x27;#validate&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="facebook_feeds_block"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#facebook_feeds_block" title="Direct link to heading">#</a>facebook_feeds_block</h3><p>Affichage des feeds FB via un bloc.</p><p>Pour obtenir un access de page token  : <a href="https://elfsight.com/blog/2017/10/how-to-get-facebook-access-token/">https://elfsight.com/blog/2017/10/how-to-get-facebook-access-token/</a> Dans le cas de ce block, il faut le page access token.</p><p>La solution pour obtenir un jeton qui dure toujours :
Here&#x27;s my solution using only Graph API Explorer &amp; Access Token Debugger:</p><ul><li>Graph API Explorer:</li><li>Select your App from the top right dropdown menu</li><li>Select &quot;Get User Access Token&quot; from dropdown (right of access token field) and select needed permissions</li><li>Copy user access token</li><li>Access Token Debugger:</li><li>Paste copied token and press &quot;Debug&quot;</li><li>Press &quot;Extend Access Token&quot; and copy the generated long-lived user access token</li><li>Graph API Explorer:</li><li>Paste copied token into the &quot;Access Token&quot; field</li><li>Make a GET request with &quot;PAGE_ID?fields=access_token&quot;</li><li>Find the permanent page access token in the response (node &quot;access_token&quot;)</li><li>(Optional) Access Token Debugger:</li><li>Paste the permanent token and press &quot;Debug&quot;</li><li>&quot;Expires&quot; should be &quot;Never&quot;</li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/book-drupal/docs/ckeditor"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« <!-- -->ckeditor</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/book-drupal/docs/dev"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">dev<!-- --> »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#core" class="contents__link">Core</a><ul class=""><li><a href="#statistics" class="contents__link">statistics</a></li></ul></li><li><a href="#contrib" class="contents__link">Contrib</a><ul class=""><li><a href="#cookieconsent" class="contents__link">cookieconsent</a></li><li><a href="#simple-popup-blocks" class="contents__link">simple popup blocks</a></li><li><a href="#simplenews" class="contents__link">Simplenews</a></li><li><a href="#metatag" class="contents__link">Metatag</a></li><li><a href="#elasticsearch" class="contents__link">ElasticSearch</a></li><li><a href="#videos-transcoding" class="contents__link">Videos transcoding</a></li><li><a href="#redis" class="contents__link">Redis</a></li><li><a href="#webform" class="contents__link">Webform</a></li><li><a href="#webform-recaptcha" class="contents__link">Webform recaptcha</a></li><li><a href="#datalayer" class="contents__link">Datalayer</a></li><li><a href="#amp" class="contents__link">AMP</a></li><li><a href="#flag" class="contents__link">flag</a></li><li><a href="#site-settings" class="contents__link">Site settings</a></li><li><a href="#hierarchical_term_formatter" class="contents__link">hierarchical_term_formatter</a></li><li><a href="#taxonomy_menu" class="contents__link">taxonomy_menu</a></li><li><a href="#maestro--business-process-workflow" class="contents__link">Maestro : business process workflow</a></li><li><a href="#rgpd--tarte-au-citron" class="contents__link">RGPD : Tarte au citron</a></li></ul></li><li><a href="#custom" class="contents__link">Custom</a><ul class=""><li><a href="#instagram" class="contents__link">Instagram</a></li><li><a href="#view_filter" class="contents__link">view_filter</a></li><li><a href="#simplenews_ajax" class="contents__link">simplenews_ajax</a></li><li><a href="#facebook_feeds_block" class="contents__link">facebook_feeds_block</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/book-drupaldocs/introduction">Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://abecms.slack.com">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Website</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://livingcolor.fr">Website</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="https://docusaurus.io/img/oss_logo.png"/></a></div>Copyright © 2019 Abe SAS. Built with Docusaurus.</div></div></footer>
</div>

<script type="text/javascript" src="/book-drupalstyles.52233a80.js"></script>

<script type="text/javascript" src="/book-drupalruntime~main.bf17f02f.js"></script>

<script type="text/javascript" src="/book-drupalmain.9c2c4e27.js"></script>

<script type="text/javascript" src="/book-drupal1.8a8ccd09.js"></script>

<script type="text/javascript" src="/book-drupal27.8d612f21.js"></script>

<script type="text/javascript" src="/book-drupal1b017fc8.c58a1f3a.js"></script>

<script type="text/javascript" src="/book-drupal17896441.a4bc64a1.js"></script>

<script type="text/javascript" src="/book-drupal23d28cd9.a5842da9.js"></script>


</body>
</html>