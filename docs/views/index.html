<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">

<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"17896441":["/17896441.e9c11e14.js"],"main":["/main.33f566fa.js"],"0e800433":["/0e800433.42d969ff.js"],"1be78505":[],"20ac7829":["/20ac7829.5e6f2fab.js"],"23d28cd9":["/23d28cd9.3ebaf342.js"],"3847b3ea":["/3847b3ea.bc3e66a8.js"],"3f607676":["/3f607676.f5ab2895.js"],"42b7455d":["/42b7455d.bff633b1.js"],"4cc4d2ba":["/4cc4d2ba.20b8dc5a.js"],"5caa2f80":["/5caa2f80.5f218aae.js"],"605b7772":["/605b7772.f4a03246.js"],"645d743a":["/645d743a.7c65d23b.js"],"683be167":["/683be167.edc449be.js"],"6aeeabde":["/6aeeabde.e88c0127.js"],"7047bd09":["/7047bd09.d96d4f9e.js"],"816165d5":["/816165d5.d0c55e5a.js"],"950718c7":["/950718c7.3cf64613.js"],"9ed00105":["/9ed00105.3a2bda90.js"],"a09c2993":["/a09c2993.7c1e6534.js"],"a303f551":["/a303f551.2c8ac8a9.js"],"ba0cd7c5":["/ba0cd7c5.f1e6523c.js"],"c4f5d8e4":["/c4f5d8e4.6711272c.js"],"cbc948ce":["/cbc948ce.fac82fce.js"],"ce3e42ad":["/ce3e42ad.83614819.js"],"d59a3898":["/d59a3898.2916534c.js"],"febdf506":["/febdf506.c363fe48.js"]};/*]]>*/</script>

<title data-react-helmet="true">views</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" property="og:title" content="Drupal Stickers Book · Build a Drupal website in no time !"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="description" content="# Views"/><meta data-react-helmet="true" property="og:description" content="# Views"/><meta data-react-helmet="true" property="og:url" content="https://drupal.livingcolor.academy/docs/views"/>

<link data-react-helmet="true" rel="shortcut icon" href="/img/logo-white.png"/>


<link rel="stylesheet" type="text/css" href="/styles.fcdbc45b.css" />

</head>
<body >
<script type="text/javascript">(function() {
  function setDataThemeAttribute(theme) {
    document.querySelector('html').setAttribute('data-theme', theme);
  }
  
  var preferDarkQuery = '(prefers-color-scheme: dark)';
  var mql = window.matchMedia(preferDarkQuery);
  var supportsColorSchemeQuery = mql.media === preferDarkQuery;
  var localStorageTheme = null;
  try {
    localStorageTheme = localStorage.getItem('theme');
  } catch (err) {}
  var localStorageExists = localStorageTheme !== null;

  if (localStorageExists) {
    setDataThemeAttribute(localStorageTheme);
  } else if (supportsColorSchemeQuery && mql.matches) {
    setDataThemeAttribute('dark');
  }
})();</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.png" alt="livingcolor"/><strong class="">Drupal Stickers Recipes</strong></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.png" alt="livingcolor"/><strong>Drupal Stickers Recipes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/setup">setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/configuration">configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/multilingue">multilingue</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tests">tests</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/webforms">webforms</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Dynamisation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/nodes">nodes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/paragraphs">paragraphs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/views">views</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/forms">forms</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/taxonomies">taxonomies</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tokens">tokens</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/images">images</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/users">users</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/comments">comments</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/newsletters">newsletters</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/menus">menus</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ckeditor">ckeditor</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/modules">modules</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dev specific</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/dev">dev</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">views</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="views"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#views" title="Direct link to heading">#</a>Views</h1><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="introduction"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction" title="Direct link to heading">#</a>Introduction</h2><p>ATTENTION: Lorsque l&#x27;on fait des views avec affichage de node (dans la config de la vue: format afficher contenu), l&#x27;utilisation des twigs de node associés aux vues fonctionne mal et si vous avez plusieurs vues difféfentes qui affichent les même type de contenu node, leur affichage ne fonctionnera pas correctement. C&#x27;est un bug Drupal 8 connu: <a href="https://drupal.stackexchange.com/questions/248748/twig-templates-for-nodes-in-different-views/248768">https://drupal.stackexchange.com/questions/248748/twig-templates-for-nodes-in-different-views/248768</a>
Pour résoudre ce problème, utiliser des modes d&#x27;affichage différents (full, teaser, default ...) pour les nodes.
Par exemple pour une vue &quot;agenda&quot; qui affiche des nodes dont le type de contenu est &quot;event&quot; : au lieu de créer un twig node--view--agenda.html.twig, utiliser un node--event--full.html.twig</p><blockquote><blockquote><p>Dans les vues, n&#x27;utiliser que des unformatted list of fields avec affichage du Node dans mode d&#x27;affichage différent par bloc de vue</p></blockquote></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="gérer-les-répétitions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#gérer-les-répétitions" title="Direct link to heading">#</a>Gérer les répétitions</h3><ol><li>Pour éviter qu&#x27;un même résultat se répète dans l&#x27;affichage :</li></ol><ul><li>Ouvrir les paramètres avancés de la vue</li><li>Passer &quot;utiliser l&#x27;agrégation&quot; de &#x27;non&#x27; à &#x27;oui&#x27;</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="créer-une-page-de-vue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créer-une-page-de-vue" title="Direct link to heading">#</a>Créer une page de vue</h3><ol><li>Créer une view du nom de &quot;Actualités&quot;</li><li>show content of type article sorted by newest first</li><li>Create a page doit être coché, le nom de la page sera &quot;actualites&quot;</li><li>Display format: Unformatted list of fields.</li><li>Vider Items to display et décocher &quot;Use a pager&quot;</li><li>Save and Edit</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="permettre-la-sélection-à-lutilisateur"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#permettre-la-sélection-à-lutilisateur" title="Direct link to heading">#</a>Permettre la sélection à l&#x27;utilisateur</h3><ol><li>Ajouter un &quot;filter criteria&quot;, on ajoute Content: Tags / Non exposé aux utilisateurs</li><li>Ajouter un &quot;filter criteria&quot;, on ajoute Content: Département, Sites, Marchés, Thématiques :</li><li>Sélectionner le mode dropdown</li><li>Sélectionner Expose this filter to visitors</li><li>Sélectionner Single filter</li><li>puis Operator &quot;is one of&quot;</li><li>Ajouter un &quot;filter criteria&quot;, on ajoute Content: Date / Est compris entre</li><li>Sauvegarder</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="implémenter-ajax"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#implémenter-ajax" title="Direct link to heading">#</a>Implémenter Ajax</h3><ol><li>Cliquer sur Advanced</li><li>Use Ajax</li></ol><p>Il faudra ensuite utiliser le module custom view_filter que nous avons créé</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="permettre-laffichage-de-résultats-en-fonction-de-2-champs-contextuels-différents"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#permettre-laffichage-de-résultats-en-fonction-de-2-champs-contextuels-différents" title="Direct link to heading">#</a>Permettre l&#x27;affichage de résultats en fonction de 2 champs contextuels différents</h2><p>Ex. J&#x27;ai créé un champ au niveau du node article appelé &quot;co-auteur&quot;. Ainsi un utilisateur peut-être auteur ou co-auteur d&#x27;un article. Pour afficher tous les articles dans lesquels il est auteur ou co-auteur :
utiliser le module <code>views_contextual_filters_or</code></p><p>Puis dans la vue :</p><ul><li>Mettre les 2 champs en filtres contextuels avec &quot;fournir une valeur par défaut&quot; (ici identifiant depuis le contexte de la route car je veux les articles de la personne loggée en ce moment).
-Dans paramètres de la requête, cocher &quot;contextual filter OR&quot;</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="titre-dune-vue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#titre-dune-vue" title="Direct link to heading">#</a>Titre d&#x27;une vue</h2><p>le titre de votre vue ne s&#x27;affiche pas en front...
Pour l&#x27;afficher en front, il faut dans un module mettre :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Add title of the view on the views...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * + style on the krug lovers form</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function customization_preprocess_views_view(&amp;$variables) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $view = $variables[&#x27;view&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $variables[&#x27;title&#x27;] = [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;#markup&#x27; =&gt; $view-&gt;getTitle(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Vous pourrez alors afficher le titre de la vue sur votre front : {{title}}</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="passer-une-variable-à-une-vue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#passer-une-variable-à-une-vue" title="Direct link to heading">#</a>Passer une variable à une vue</h2><ul><li>Depuis Twig Tweak, on peut faire ça :</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ drupal_view(&#x27;article_a_lire_aussi&#x27;, &#x27;block_1&#x27;, 10) }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Ce nombre 10 sera récupéré sur la vue ou sur l&#x27;unformatted de la vue avec :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">view.args[0]</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>!! A noter !! Cet argument (10) peut être lié avec des contextual filters :
Exemple : On créé un contextual filter sur l&#x27;id, 10 correspond à l&#x27;id d&#x27;un node.</p><p>Par exemple je suis sur un node de contenu et je veux faire varier le nb d&#x27;items de ma vue en fonction du nombre d&#x27;items que j&#x27;ai sur un field &quot;field_a_lire_aussi&quot;, du côté de mon node :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% for alire in content.field_a_lire_aussi[&#x27;#items&#x27;].getIterator() %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {{ drupal_entity(&#x27;node&#x27;, alire.entity.id(), &#x27;teaser&#x27;) }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% set nb = content.field_a_lire_aussi[&#x27;#items&#x27;].getIterator()|length %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ drupal_view(&#x27;article_a_lire_aussi&#x27;, &#x27;block_1&#x27;, nb) }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>et dans mon docroot/themes/custom/inaglobal/templates/view/article-a-lire-aussi/views-view-unformatted--article-a-lire-aussi.html.twig :</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% set nbAlreadyDisplayed = (3 - view.args[0]) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% for row in rows %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% if loop.index &lt;= nbAlreadyDisplayed %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {{ row.content }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {% if loop.index != loop.last %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;div class=&quot;mb-2&quot;&gt;&lt;/div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {% endif %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% endif %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endfor %}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="afficher-tous-les-nodes-qui-ont-le-même-referenced-entity-parent"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#afficher-tous-les-nodes-qui-ont-le-même-referenced-entity-parent" title="Direct link to heading">#</a>Afficher tous les nodes qui ont le même referenced entity parent</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="exemple"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#exemple" title="Direct link to heading">#</a>Exemple</h3><ul><li>J&#x27;ai un type de contenu &quot;série&quot;</li><li>J&#x27;ai un type de contenu &quot;épisode&quot;</li><li>chaque épisode référence une entité série via &quot;field_serie&quot;</li><li>Lorsque j&#x27;affiche un épisode, je veux afficher TOUS les autres épisodes de cette série</li></ul><ol><li>Je crée dans ma vue une relation &quot;content référencé depuis field_serie&quot;</li><li>Je crée une autre relation &quot;content utilise field_serie&quot; avec comme relation la relation précédente</li><li>Je crée un filtre contextuel sur l&#x27;ID de node avec en relation la seconde (content utilise field_serie) et je fournis en valeur par défaut identifiant (ID) à partir de l&#x27;URL
=&gt; Cela va afficher tous les épisodes de la série (y compris celui qui s&#x27;affiche en épisode pricnipal sur ma page)</li><li>Je crée un nouveau filtre contextuel sur l&#x27;ID de node (encore) sans relation et avec en valeur par défaut l&#x27;identifiant à partir de l&#x27;URL et tout en bas dans &quot;more&quot; je clique sur exclure
=&gt; Cela affiche TOUS les épisodes de la série de l&#x27;épisode affiché sur la page, sauf l&#x27;épisode lui-même !</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="traductions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#traductions" title="Direct link to heading">#</a>Traductions</h2><ol><li>Ajouter un critère de filtre</li><li>Séléctionner &quot;content : translation language&quot;</li><li>Filtrer sur &quot;Interface text language selected for page&quot;</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="créer-une-url-de-vue-en-fonction-de-la-langue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créer-une-url-de-vue-en-fonction-de-la-langue" title="Direct link to heading">#</a>Créer une URL de vue en fonction de la langue</h2><ol><li>Aller dans &#x27;admin/configuration/url aliases&#x27; et créer un alias du chemin de la vue dans la langue souhaitée. Pour l&#x27;utiliser depuis twig, se référer à &quot;Afficher l&#x27;url d&#x27;une vue&quot; plus haut.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="créer-une-vue-dadmin"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créer-une-vue-dadmin" title="Direct link to heading">#</a>Créer une vue d&#x27;admin</h2><ul><li>Créer une vue</li><li>Dans la vue : Lui mettre un chemin d&#x27;url (qui commence par /admin)</li><li>Dans la vue : L&#x27;associer à un menu de la navigation admin</li><li>Pour rendre les colonnes triables au clic sur l&#x27;entête, dans le Format:Tableau entrer dans <strong>Paramètres</strong> et cocher les cases dans la colonne <strong>Classable</strong></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="créér-un-bouton-daction-sur-les-vues-dadmin"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créér-un-bouton-daction-sur-les-vues-dadmin" title="Direct link to heading">#</a>Créér un bouton d&#x27;action sur les vues d&#x27;admin</h2><ol><li>Activer le module Views Add Button</li><li>Dans la vue concernée, dans ENTETE, ajouter et configurer un Entity Add Button :</li></ol><ul><li>Entity Type = Sélectionner l&#x27;entité concernée</li><li>Button Text for the add button = Libellé du bouton (e.g. Ajouter un article)</li><li>Button classes for the add link = Coller les classes : button button-action button--primary button--small</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="vue-par-défaut-dadmin-des-contenus"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#vue-par-défaut-dadmin-des-contenus" title="Direct link to heading">#</a>Vue par défaut d&#x27;admin des contenus</h2><p>Si la vue admin/content n&#x27;existe plus (supprimé par erreur ou supprimé par Drupal), voici le moyen de la recréer :</p><ul><li>Goto Configuration &gt; Development &gt; Synchronization &gt; Import tab &gt; Single item, Configuration type: View and paste into the code below into &quot;Paste your configuration here&quot; and press Import. et importer la vue qui est sauvegardée en yml.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="créer-une-vue-rss"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#créer-une-vue-rss" title="Direct link to heading">#</a>Créer une vue RSS</h2><ol><li>Ajouter une page de type Flux à la vue content par défaut</li><li>Paramètre du flux : Créer le chemin (e.g. /rss)</li><li>Configurer la vue :</li></ol><ul><li>Ajouter les champs Titre, chapo, publié le, écrit par, lien vers le contenu (rendre l&#x27;url en tant que texte)</li><li>Format : Afficher Paramètre puis faire la mapping avec les champs ajouter précédemment</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="configurer-les-liens"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configurer-les-liens" title="Direct link to heading">#</a>Configurer les liens</h3><p>Il s&#x27;agit d&#x27;une vue.
Pour créer le lien vers les nodes, utiliser l&#x27;id de chaque node et faire une réécriture de ces ids avec <code>/node/{{nid}}</code> dedans.
Ils seront réécris avec la bonne url</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="exporter-une-vue-en-csv"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#exporter-une-vue-en-csv" title="Direct link to heading">#</a>Exporter une vue en csv</h2><p>Permettre l&#x27;export du catalogue: utiliser les plugins csv_serialization et views_data_export.</p><ul><li>Aller dans la vue et créer une vue exportation des données. Bien lister l&#x27;ensemble des infos et vérifier que dans format/paramètres, la case &quot;csv&quot; est bien cochée. Vérifier que la vue fonctionne puis mettre le chemin souhaité (ex. /admin/export/catalogue fichier: catalogue.csv). Aller dans Admin/Structure/menus/administration/ajouter un lien et mettre le lien vers cet export avec : /admin/export/catalogue?_format=csv</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="filtrer-par-année"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#filtrer-par-année" title="Direct link to heading">#</a>Filtrer par année</h2><p>ATTENTION : pour filtrer par année : il faut un patch a views : <a href="https://www.drupal.org/files/issues/2786577-270_0.patch">https://www.drupal.org/files/issues/2786577-270_0.patch</a></p><ul><li>article <a href="https://www.flocondetoile.fr/blog/filter-content-year-views-drupal-8">https://www.flocondetoile.fr/blog/filter-content-year-views-drupal-8</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="search"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#search" title="Direct link to heading">#</a>Search</h2><p>Pour pouvoir rechercher des views, on a utilisé un trick (Drupal ne sait pas faire de l&#x27;index SolR sur les vues...):
1. On crée un type de contenu bloc (search-views) avec un titre et un lien et un body
1. Pour chaque lien vers une page de views qu&#x27;on veut trouver, on crée un bloc de ce type
1. On va ajouter ce bloc dans le search index Drupal en mettant un poids fort au titre du bloc (pour qu&#x27;il ressorte en premier)
1. Dans la vue de recherche on n&#x27;oublie pas d&#x27;ajouter les champs de ces blocs en résultat.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ne-pas-afficher-le-node-actif-dans-une-vue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#ne-pas-afficher-le-node-actif-dans-une-vue" title="Direct link to heading">#</a>Ne pas afficher le node actif dans une vue</h2><p>Si vous avez une vue intégrée dans un node (par exemple &quot;autres articles&quot; affichés sous un article) et que vous ne voulez pas que le node actif ne s&#x27;affiche dans la vue:</p><ul><li>Aller dans la vue, filtre contextuel</li><li>Ajouter l&#x27;ID et remplir &quot;fournir une valeur par défaut&quot; &quot;Quand la valeur de filtre n&#x27;est pas dispo&quot; avec l&#x27;IDdu contenu à partir de l&#x27;URL</li><li>Tout en bas, dans &quot;MORE&quot;, cocher exclure, pour exclure cette valeur d&#x27;ID.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="form-exposed--ajouter-un-style-ou-une-classe-au-tag-form"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#form-exposed--ajouter-un-style-ou-une-classe-au-tag-form" title="Direct link to heading">#</a>form exposed : Ajouter un style ou une classe au tag <code>&lt;form&gt;</code></h2><p>  Le twig exposed ne contient pas le tag form. Il faut passer par un module pour modifier ce tag. Par exemple:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Add style on the lovers form</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function customization_preprocess_views_view(&amp;$variables) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if ($variables[&#x27;id&#x27;] === &#x27;lovers&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $variables[&#x27;exposed&#x27;][&#x27;#attributes&#x27;][&#x27;style&#x27;] = &#x27;display:flex; align-self: flex-end&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Sur le formulaire de la vue lovers, on va ajouter <code>style=&quot;display:flex; align-self: flex-end&quot;</code> sur le tag form.
Pour ajouter une classe : <code>$variables[&#x27;exposed&#x27;][&#x27;#attributes&#x27;][&#x27;class&#x27;][] = &#x27;myClass&#x27;;</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="form-exposed--séparer-le-champ-sort_by-des-champs-de-filtrage-"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#form-exposed--séparer-le-champ-sort_by-des-champs-de-filtrage-" title="Direct link to heading">#</a>form exposed : Séparer le champ sort_by des champs de filtrage :</h2><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ form|without(&#x27;sort_by&#x27;) }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{{ form.sort_by }}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>Il suffit d&#x27;afficher d&#x27;abord le form SANS le field en question, puis afficher séparément le field voulu. Valable pour d&#x27;autres objets Drupal.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="form-exposed--skinner-les-champs-de-filtre-et-de-tri"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#form-exposed--skinner-les-champs-de-filtre-et-de-tri" title="Direct link to heading">#</a>form exposed : Skinner les champs de filtre et de tri</h2><p>une première solution est d&#x27;utiliser le module BEF (Better Exposed Filter), mais cela peut-être compliqué d&#x27;arriver au résultat souhaité.</p><p>Une autre solution : Le faire soi-même. Voici comment créer un filtrage + tri en ajax sur une vue.</p><ol><li>Cocher &quot;ajax&quot; dans la vue, configurer les filtres et les tris exposés à l&#x27;utilisateur (si on ne veut pas rendre l&#x27;ordre de tri sléecitonnable par défaut, il faut aller le décocher dans Advanced/exposed form/Exposed form style/settings)</li><li>sur le front, utiliser les suggestions pour spécialiser le html de l&#x27;exposed et des champs.
Pour remplacer un select par des ul/li par exemple, il suffit de cacher le select, de cacher le bouton de soumission du formulaire, et d&#x27;ajouter du js pour qu&#x27;au clic sur un li, on mette à jour la valeur du select puis on clique sur le bouton de soumission. Exemple pour un &quot;trier par&quot; on créer un twig <code>select--sort-by.html.twig</code> :</li></ol><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% spaceless %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;select{{ attributes.addClass(&#x27;js-select-sortby&#x27;).setAttribute(&#x27;style&#x27;, &#x27;display:none&#x27;) }}&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% for option in options %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {% if option.type == &#x27;optgroup&#x27; %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;optgroup label=&quot;{{ option.label }}&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          {% for sub_option in option.options %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;option value=&quot;{{ sub_option.value }}&quot;{{ sub_option.selected ? &#x27; selected=&quot;selected&quot;&#x27; }}&gt;{{ sub_option.label }}&lt;/option&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          {% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/optgroup&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {% elseif option.type == &#x27;option&#x27; %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;option value=&quot;{{ option.value }}&quot;{{ option.selected ? &#x27; selected=&quot;selected&quot;&#x27; }}&gt;{{ option.label }}&lt;/option&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {% endif %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;/select&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endspaceless %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;div class=&quot;filter-block&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;ul class=&quot;filter-list w-list-unstyled&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {% for option in options %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;li class=&quot;filter-item{{ option.selected ? &#x27; active&#x27; }}&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;div data-selectid=&quot;{{ option.value }}&quot; class=&quot;js-select-ajax-sortby&quot;&gt;{{ option.label }}&lt;/div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {% if option.selected %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;script&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  if (window.jQuery) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      jQuery(&#x27;.filter-container&#x27;).find(&#x27;.js-btn-sortby&#x27;).html(&#x27;{{ option.label }}&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;/script&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {% endif %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;/ul&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;script&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (!window.jQuery) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  document.addEventListener(&quot;DOMContentLoaded&quot;, function(event) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    jQuery(&#x27;.js-select-ajax-sortby&#x27;).on(&#x27;click&#x27;, function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        jQuery(this).closest(&#x27;.filter-selector&#x27;).find(&#x27;.js-select-sortby&#x27;).val(jQuery(this).data(&#x27;selectid&#x27;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        jQuery(this).closest(&#x27;form&#x27;).find(&#x27;.js-form-submit&#x27;).click()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  jQuery(&#x27;.js-select-ajax-sortby&#x27;).on(&#x27;click&#x27;, function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      jQuery(this).closest(&#x27;.filter-selector&#x27;).find(&#x27;.js-select-sortby&#x27;).val(jQuery(this).data(&#x27;selectid&#x27;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      jQuery(this).closest(&#x27;form&#x27;).find(&#x27;.js-form-submit&#x27;).click()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/script&gt;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>La première partie est du copier/coller du select d&#x27;origine avec <code>.addClass(&#x27;js-select-sortby&#x27;).setAttribute(&#x27;style&#x27;, &#x27;display:none&#x27;)</code>qui permet de lui attacher une classe qui nous servira à le trouver facilement, et un atrribut display:none pour le cacher.</p><p>La seconde partie est le html souhaité.
Le js, enfin permet de détecter quand on clique sur le li de :
1. retrouver le select et lui mettre la valeur sélectionnée
2. cliquer sur le bouton &quot;soumettre&quot; qui va faire l&#x27;appel ajax.</p><p>Le test <code>if(!window.jQuery)</code> permet de savoir si on load ce twig avec la page (au premier chargement), ou si ce twig est retourné lors des appels ajax suivants. C&#x27;est aussi simple que ça ! En conservant le select d&#x27;origine de Drupal, on bénéficie de toutes ses fonctionnalités associées (appel d&#x27;ajax).</p><p>Une autre solution pour le js serait de le déplacer dans un drupal-ajax.js.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="dans-une-view-dans-lexposed-filter-nafficher-que-les-termes-de-taxonomie-qui-ont-au-moins-un-node-associé"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#dans-une-view-dans-lexposed-filter-nafficher-que-les-termes-de-taxonomie-qui-ont-au-moins-un-node-associé" title="Direct link to heading">#</a>Dans une view, dans l&#x27;exposed filter, n&#x27;afficher que les termes de taxonomie qui ont au moins un node associé</h2><p>dans le fichier montheme.theme, créer 2 fonctions:</p><ul><li>getNodesByTaxonomyTermIds va ramener le tableau de termIds qui ont au moins un node associé</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function montheme_form_views_exposed_form_alter(&amp;$form, &amp;$form_state, $form_id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if($form[&#x27;#id&#x27;] == &#x27;views-exposed-form-agenda-page-1&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Kint::dump($form);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $termIds = getNodesByTaxonomyTermIds(array_keys($form[&#x27;field_thematiques_target_id&#x27;][&#x27;#options&#x27;]));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach ($form[&#x27;field_thematiques_target_id&#x27;][&#x27;#options&#x27;] as $term_key =&gt; $term) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if(!in_array($term_key,$termIds)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Check if this is a child by looking for &#x27;-&#x27; as first char in string</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        unset($form[&#x27;field_thematiques_target_id&#x27;][&#x27;#options&#x27;][$term_key]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getNodesByTaxonomyTermIds($termIds){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $termIds = (array) $termIds;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if(empty($termIds)){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return $termIds;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query = \Drupal::database()-&gt;select(&#x27;taxonomy_index&#x27;, &#x27;ti&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query-&gt;fields(&#x27;ti&#x27;, array(&#x27;tid&#x27;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query-&gt;innerJoin(&#x27;node&#x27;, &#x27;n&#x27;, &#x27;n.nid = ti.nid&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query-&gt;condition(&#x27;ti.tid&#x27;, $termIds, &#x27;IN&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query-&gt;condition(&#x27;n.type&#x27;, &#x27;evenement&#x27;, &#x27;=&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $query-&gt;groupBy(&#x27;tid&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $result = $query-&gt;execute();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $termIds = $result-&gt;fetchCol());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return $termIds;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><ul><li>Pour ne pas afficher les enfants de la taxonomie, il suffit dans les critères de filtrage de sélectionner uniquement les valeurs à afficher puis à cocher &quot;limiter la liste aux éléments sélectionnés&quot;.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="appeler-un-template-de-node-dans-une-vue-en-fonction-de-sa-position-dans-la-vue"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#appeler-un-template-de-node-dans-une-vue-en-fonction-de-sa-position-dans-la-vue" title="Direct link to heading">#</a>Appeler un template de node dans une vue en fonction de sa position dans la vue</h2><ul><li>dans &quot;montheme.theme&quot;:<pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function montheme_theme_suggestions_node_alter(&amp;$suggestions, array $variables) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $suggestions[] = sprintf(&#x27;%s__%s&#x27;, $suggestions[count($suggestions) - 2], $variables[&#x27;elements&#x27;][&#x27;#view_mode&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre></li><li>le code dans le twig &quot;views-view--unformatted&quot;:<pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% for row in rows %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% set rowContent = row.content %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% if loop.first %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {% set rowContent = rowContent | merge({&#x27;#view_mode&#x27;: &#x27;full_1&#x27;}) %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% endif %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {{ rowContent }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {% endfor %}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre></li><li>créer un twig personnalisé &quot;node--view--hub-articles--full-1.html.twig&quot;.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="passer-lindex-du-node-dans-la-vue-au-node"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#passer-lindex-du-node-dans-la-vue-au-node" title="Direct link to heading">#</a>Passer l&#x27;index du node dans la vue au node</h2><p>pour un twig node--evenement--default:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function montheme_preprocess_node__evenement__default(&amp;$vars) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $view = $vars[&#x27;view&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $node = $vars[&#x27;node&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach($view-&gt;result as $key =&gt; $row){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if($row-&gt;nid == $node-&gt;id()){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $vars[&#x27;row_index&#x27;] = $row-&gt;index;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>(si le twig s&#x27;appellait node--view--home-evenements.html.twig, on aurait comme nom de fonction
montheme_preprocess_node<strong>view</strong>home_evenements(&amp;$vars))</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="pour-interpréter-le-html-dun-champ"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#pour-interpréter-le-html-dun-champ" title="Direct link to heading">#</a>Pour interpréter le HTML d&#x27;un champ</h2><ul><li>dans le cas d&#x27;une vue qui expose des champs, il faut faire :</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function h1765_preprocess_views_view_field(&amp;$variables, $hook) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $name = $variables[&#x27;field&#x27;]-&gt;field;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  switch($name){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    case &#x27;field_chapo&#x27;:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      $variables[&#x27;output&#x27;] = html_entity_decode($variables[&#x27;output&#x27;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><ul><li>et créer le views-view-field--field-NOMDUCHAMP.html.twig avec {{ output|raw}}</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="corriger-lerreur-daffichage-des-enfants-dans-une-view-"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#corriger-lerreur-daffichage-des-enfants-dans-une-view-" title="Direct link to heading">#</a>Corriger l&#x27;erreur d&#x27;affichage des enfants dans une view :</h2><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% for row in rows %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {{ row.content }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% endfor %}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="afficher-le-nom-dune-valeur-de-taxonomie-depuis-un-row-in-rows"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#afficher-le-nom-dune-valeur-de-taxonomie-depuis-un-row-in-rows" title="Direct link to heading">#</a>Afficher le nom d&#x27;une valeur de taxonomie depuis un row in rows</h2><p><code>{{ row.content[&#x27;#node&#x27;].field_categorie_document.0.entity.name.value }}</code></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/paragraphs"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« <!-- -->paragraphs</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/forms"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">forms<!-- --> »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#introduction" class="contents__link">Introduction</a><ul class=""><li><a href="#gérer-les-répétitions" class="contents__link">Gérer les répétitions</a></li><li><a href="#créer-une-page-de-vue" class="contents__link">Créer une page de vue</a></li><li><a href="#permettre-la-sélection-à-lutilisateur" class="contents__link">Permettre la sélection à l'utilisateur</a></li><li><a href="#implémenter-ajax" class="contents__link">Implémenter Ajax</a></li></ul></li><li><a href="#permettre-laffichage-de-résultats-en-fonction-de-2-champs-contextuels-différents" class="contents__link">Permettre l'affichage de résultats en fonction de 2 champs contextuels différents</a></li><li><a href="#titre-dune-vue" class="contents__link">Titre d'une vue</a></li><li><a href="#passer-une-variable-à-une-vue" class="contents__link">Passer une variable à une vue</a></li><li><a href="#afficher-tous-les-nodes-qui-ont-le-même-referenced-entity-parent" class="contents__link">Afficher tous les nodes qui ont le même referenced entity parent</a><ul class=""><li><a href="#exemple" class="contents__link">Exemple</a></li></ul></li><li><a href="#traductions" class="contents__link">Traductions</a></li><li><a href="#créer-une-url-de-vue-en-fonction-de-la-langue" class="contents__link">Créer une URL de vue en fonction de la langue</a></li><li><a href="#créer-une-vue-dadmin" class="contents__link">Créer une vue d'admin</a></li><li><a href="#créér-un-bouton-daction-sur-les-vues-dadmin" class="contents__link">Créér un bouton d'action sur les vues d'admin</a></li><li><a href="#vue-par-défaut-dadmin-des-contenus" class="contents__link">Vue par défaut d'admin des contenus</a></li><li><a href="#créer-une-vue-rss" class="contents__link">Créer une vue RSS</a><ul class=""><li><a href="#configurer-les-liens" class="contents__link">Configurer les liens</a></li></ul></li><li><a href="#exporter-une-vue-en-csv" class="contents__link">Exporter une vue en csv</a></li><li><a href="#filtrer-par-année" class="contents__link">Filtrer par année</a></li><li><a href="#search" class="contents__link">Search</a></li><li><a href="#ne-pas-afficher-le-node-actif-dans-une-vue" class="contents__link">Ne pas afficher le node actif dans une vue</a></li><li><a href="#form-exposed--ajouter-un-style-ou-une-classe-au-tag-form" class="contents__link">form exposed : Ajouter un style ou une classe au tag <code>&lt;form&gt;</code></a></li><li><a href="#form-exposed--séparer-le-champ-sort_by-des-champs-de-filtrage-" class="contents__link">form exposed : Séparer le champ sort_by des champs de filtrage :</a></li><li><a href="#form-exposed--skinner-les-champs-de-filtre-et-de-tri" class="contents__link">form exposed : Skinner les champs de filtre et de tri</a></li><li><a href="#dans-une-view-dans-lexposed-filter-nafficher-que-les-termes-de-taxonomie-qui-ont-au-moins-un-node-associé" class="contents__link">Dans une view, dans l'exposed filter, n'afficher que les termes de taxonomie qui ont au moins un node associé</a></li><li><a href="#appeler-un-template-de-node-dans-une-vue-en-fonction-de-sa-position-dans-la-vue" class="contents__link">Appeler un template de node dans une vue en fonction de sa position dans la vue</a></li><li><a href="#passer-lindex-du-node-dans-la-vue-au-node" class="contents__link">Passer l'index du node dans la vue au node</a></li><li><a href="#pour-interpréter-le-html-dun-champ" class="contents__link">Pour interpréter le HTML d'un champ</a></li><li><a href="#corriger-lerreur-daffichage-des-enfants-dans-une-view-" class="contents__link">Corriger l'erreur d'affichage des enfants dans une view :</a></li><li><a href="#afficher-le-nom-dune-valeur-de-taxonomie-depuis-un-row-in-rows" class="contents__link">Afficher le nom d'une valeur de taxonomie depuis un row in rows</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://abecms.slack.com">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Website</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://livingcolor.fr">Website</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="https://docusaurus.io/img/oss_logo.png"/></a></div>Copyright © 2020 Abe SAS. Built with Docusaurus.</div></div></footer>
</div>

<script type="text/javascript" src="/styles.d03aa9ed.js"></script>

<script type="text/javascript" src="/runtime~main.fce844e1.js"></script>

<script type="text/javascript" src="/main.33f566fa.js"></script>

<script type="text/javascript" src="/1.216e67a9.js"></script>

<script type="text/javascript" src="/29.0288bebb.js"></script>

<script type="text/javascript" src="/20ac7829.5e6f2fab.js"></script>

<script type="text/javascript" src="/17896441.e9c11e14.js"></script>

<script type="text/javascript" src="/d59a3898.2916534c.js"></script>


</body>
</html>