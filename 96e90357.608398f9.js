(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{144:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"rightToc",(function(){return l})),t.d(n,"metadata",(function(){return c})),t.d(n,"default",(function(){return u}));var a=t(1),r=t(9),i=(t(0),t(160)),o={},l=[{value:"Back-office",id:"back-office",children:[]},{value:"Code Debug",id:"code-debug",children:[]}],c={id:"dev/debug",title:"debug",description:"# Comment debug l'envoi de mail dans webform",source:"@site/docs/dev/debug.md",permalink:"/docs/dev/debug",sidebar:"docs",previous:{title:"dev",permalink:"/docs/dev/dev"},next:{title:"tests",permalink:"/docs/dev/tests"}},d={rightToc:l,metadata:c},s="wrapper";function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)(s,Object(a.a)({},d,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"comment-debug-lenvoi-de-mail-dans-webform"},"Comment debug l'envoi de mail dans webform"),Object(i.b)("h2",{id:"back-office"},"Back-office"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Dans le Back-office drupal allez dans ",Object(i.b)("inlineCode",{parentName:"li"},"admin/structure/webform")," cliquez sur contruire du formulaire et allez dans ",Object(i.b)("inlineCode",{parentName:"li"},"param\xe8tres - Courriels / Gestionnaires (Handlers)")),Object(i.b)("li",{parentName:"ul"},"Cliquez sur ",Object(i.b)("inlineCode",{parentName:"li"},"Modifier")),Object(i.b)("li",{parentName:"ul"},"Dans la section envoyez \xe0 choisir ",Object(i.b)("inlineCode",{parentName:"li"},"Adresse de courriel personnalis\xe9e")," et renseignez votre email et ",Object(i.b)("inlineCode",{parentName:"li"},"enregistrer")," en bas de page."),Object(i.b)("li",{parentName:"ul"},"Cela permet de recevoir l'email.")),Object(i.b)("h2",{id:"code-debug"},"Code Debug"),Object(i.b)("p",null,"Si la methode utlis\xe9e est php_mail. php_mail est la m\xe9those native utilis\xe9e par Drupal."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Dans le fichier ",Object(i.b)("inlineCode",{parentName:"li"},"public/core/lib/Drupal/Core/Mail/Plugin/Mail/PhpMail.php")," ligne 107 \xe0 112.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"      $mail_result = @mail(\n        $message['to'],\n        $mail_subject,\n        $mail_body,\n        $mail_headers,\n        $additional_headers\n      );\n")),Object(i.b)("p",null,"Vous pouvez print_r ou echo les ",Object(i.b)("inlineCode",{parentName:"p"},"$mail_headers")," ou ",Object(i.b)("inlineCode",{parentName:"p"},"$additional_headers")," avec le code ci-dessous: "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"      $mail_result = @mail(\n        $message['to'],\n        $mail_subject,\n        $mail_body,\n        $mail_headers,\n        $additional_headers\n      );\n      print_r($mail_headers);\n      echo 'pooooooooooo';\n      print_r($additional_headers);\n      die('tata');\n    }\n")),Object(i.b)("p",null,"Envoi du mail depuis le B.O. "),Object(i.b)("p",null,"le resultat affiche dans le navigateur : "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"MIME-Version: 1.0 Content-Type: text/html; charset=UTF-8; format=flowed Content-Transfer-Encoding: 8Bit X-Mailer: Drupal Sender: adresseduclient@adresseduclient.fr From: My Hennessy Reply-to: My Hennessy pooooooooooo-fadresseduclient@adresseduclient.frtata\n")),Object(i.b)("p",null,"Dans notre cas c'\xe9tait le sender qui posait soucis.",Object(i.b)("br",{parentName:"p"}),"\n","Le sender par d\xe9faut est celui qui est dans ",Object(i.b)("inlineCode",{parentName:"p"},"admin/config/system/site-information")," - ",Object(i.b)("inlineCode",{parentName:"p"},"Adresse de courriel"),".",Object(i.b)("br",{parentName:"p"}),"\n","Nous n'\xe9tions pas autoris\xe9 \xe0 envoyer des mails avec le sender. Nous vons donc rentr\xe9 notre adresse email comme sender."))}u.isMDXComponent=!0},160:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return u}));var a=t(0),r=t.n(a),i=r.a.createContext({}),o=function(e){var n=r.a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):Object.assign({},n,e)),t},l=function(e){var n=o(e.components);return r.a.createElement(i.Provider,{value:n},e.children)};var c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},s=Object(a.forwardRef)((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===n.indexOf(a)&&(t[a]=e[a]);return t}(e,["components","mdxType","originalType","parentName"]),s=o(t),u=a,p=s[l+"."+u]||s[u]||d[u]||i;return t?r.a.createElement(p,Object.assign({},{ref:n},c,{components:t})):r.a.createElement(p,Object.assign({},{ref:n},c))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=s;var l={};for(var d in n)hasOwnProperty.call(n,d)&&(l[d]=n[d]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var u=2;u<i;u++)o[u]=t[u];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}s.displayName="MDXCreateElement"}}]);