(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{140:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return o})),a.d(n,"rightToc",(function(){return l})),a.d(n,"metadata",(function(){return c})),a.d(n,"default",(function(){return u}));var t=a(1),r=a(9),i=(a(0),a(163)),o={},l=[{value:"Back-office",id:"back-office",children:[]},{value:"Code Debug",id:"code-debug",children:[]}],c={id:"debug",title:"debug",description:"# Comment debug l'envoi de mail dans webform",source:"@site/docs/debug.md",permalink:"/docs/debug",sidebar:"docs",previous:{title:"dev",permalink:"/docs/dev"}},d={rightToc:l,metadata:c},s="wrapper";function u(e){var n=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)(s,Object(t.a)({},d,a,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"comment-debug-lenvoi-de-mail-dans-webform"},"Comment debug l'envoi de mail dans webform"),Object(i.b)("h2",{id:"back-office"},"Back-office"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Dans le Back-office drupal allez dans ",Object(i.b)("inlineCode",{parentName:"li"},"admin/structure/webform")," cliquez sur contruire du formulaire et allez dans ",Object(i.b)("inlineCode",{parentName:"li"},"param\xe8tres - Courriels / Gestionnaires (Handlers)")),Object(i.b)("li",{parentName:"ul"},"Cliquez sur ",Object(i.b)("inlineCode",{parentName:"li"},"Modifier")),Object(i.b)("li",{parentName:"ul"},"Dans la section envoyez \xe0 choisir ",Object(i.b)("inlineCode",{parentName:"li"},"Adresse de courriel personnalis\xe9e")," et renseignez votre email et ",Object(i.b)("inlineCode",{parentName:"li"},"enregistrer")," en bas de page."),Object(i.b)("li",{parentName:"ul"},"Cela permet de recevoir l'email.")),Object(i.b)("h2",{id:"code-debug"},"Code Debug"),Object(i.b)("p",null,"Si la methode utlis\xe9e est php_mail. php_mail est la m\xe9those native utilis\xe9e par Drupal."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Dans le fichier ",Object(i.b)("inlineCode",{parentName:"li"},"public/core/lib/Drupal/Core/Mail/Plugin/Mail/PhpMail.php")," ligne 107 \xe0 112.")),Object(i.b)("pre",null,Object(i.b)("code",Object(t.a)({parentName:"pre"},{}),"      $mail_result = @mail(\n        $message['to'],\n        $mail_subject,\n        $mail_body,\n        $mail_headers,\n        $additional_headers\n      );\n")),Object(i.b)("p",null,"Vous pouvez print_r ou echo les ",Object(i.b)("inlineCode",{parentName:"p"},"$mail_headers")," ou ",Object(i.b)("inlineCode",{parentName:"p"},"$additional_headers")," avec le code ci-dessous: "),Object(i.b)("pre",null,Object(i.b)("code",Object(t.a)({parentName:"pre"},{}),"      $mail_result = @mail(\n        $message['to'],\n        $mail_subject,\n        $mail_body,\n        $mail_headers,\n        $additional_headers\n      );\n      print_r($mail_headers);\n      echo 'pooooooooooo';\n      print_r($additional_headers);\n      die('tata');\n    }\n")),Object(i.b)("p",null,"Envoi du mail depuis le B.O. "),Object(i.b)("p",null,"le resultat affiche dans le navigateur : "),Object(i.b)("pre",null,Object(i.b)("code",Object(t.a)({parentName:"pre"},{}),"MIME-Version: 1.0 Content-Type: text/html; charset=UTF-8; format=flowed Content-Transfer-Encoding: 8Bit X-Mailer: Drupal Sender: adresseduclient@adresseduclient.fr From: My Hennessy Reply-to: My Hennessy pooooooooooo-fadresseduclient@adresseduclient.frtata\n")),Object(i.b)("p",null,"Dans notre cas c'\xe9tait le sender qui posait soucis.",Object(i.b)("br",{parentName:"p"}),"\n","Le sender par d\xe9faut est celui qui est dans ",Object(i.b)("inlineCode",{parentName:"p"},"admin/config/system/site-information")," - ",Object(i.b)("inlineCode",{parentName:"p"},"Adresse de courriel"),".",Object(i.b)("br",{parentName:"p"}),"\n","Nous n'\xe9tions pas autoris\xe9 \xe0 envoyer des mails avec le sender. Nous vons donc rentr\xe9 notre adresse email comme sender."))}u.isMDXComponent=!0},163:function(e,n,a){"use strict";a.d(n,"a",(function(){return l})),a.d(n,"b",(function(){return u}));var t=a(0),r=a.n(t),i=r.a.createContext({}),o=function(e){var n=r.a.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):Object.assign({},n,e)),a},l=function(e){var n=o(e.components);return r.a.createElement(i.Provider,{value:n},e.children)};var c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},s=Object(t.forwardRef)((function(e,n){var a=e.components,t=e.mdxType,i=e.originalType,l=e.parentName,c=function(e,n){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&-1===n.indexOf(t)&&(a[t]=e[t]);return a}(e,["components","mdxType","originalType","parentName"]),s=o(a),u=t,p=s[l+"."+u]||s[u]||d[u]||i;return a?r.a.createElement(p,Object.assign({},{ref:n},c,{components:a})):r.a.createElement(p,Object.assign({},{ref:n},c))}));function u(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var i=a.length,o=new Array(i);o[0]=s;var l={};for(var d in n)hasOwnProperty.call(n,d)&&(l[d]=n[d]);l.originalType=e,l[c]="string"==typeof e?e:t,o[1]=l;for(var u=2;u<i;u++)o[u]=a[u];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}s.displayName="MDXCreateElement"}}]);